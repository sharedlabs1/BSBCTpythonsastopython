<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.22">
<title>Python Level 1 for BSBCT</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Python Level 1 for BSBCT</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_lab_python_naming_conventions_and_pep8_guidelines">Lab: Python Naming Conventions and PEP8 Guidelines</a></li>
<li><a href="#_lab_understanding_data_types_sequence_types_and_pep_8_standards">Lab: Understanding Data Types, Sequence Types, and PEP 8 Standards</a></li>
<li><a href="#_lab_looping_branching_and_advanced_sequence_operations_in_python">Lab: Looping, Branching, and Advanced Sequence Operations in Python</a></li>
<li><a href="#_lab_detailed_string_operations_in_python">Lab: Detailed String Operations in Python</a></li>
<li><a href="#_lab_comprehensive_exception_handling_in_python_insurance_domain">Lab: Comprehensive Exception Handling in Python (Insurance Domain)</a></li>
<li><a href="#_lab_advanced_datetime_operations_in_python">Lab: Advanced DateTime Operations in Python</a></li>
<li><a href="#_lab_comprehensive_guide_to_python_functions">Lab: Comprehensive Guide to Python Functions</a></li>
<li><a href="#_lab_mastering_lambda_functions_in_python_insurance_domain">Lab: Mastering Lambda Functions in Python (Insurance Domain)</a></li>
<li><a href="#_lab_mastering_lists_and_tuples_in_python">Lab: Mastering Lists and Tuples in Python</a></li>
<li><a href="#_lab_mastering_dictionaries_and_sets_in_python">Lab: Mastering Dictionaries and Sets in Python</a></li>
<li><a href="#_case_study_comprehensive_insurance_data_management_system">Case Study: Comprehensive Insurance Data Management System</a></li>
<li><a href="#_lab_mastering_file_operations_in_python">Lab: Mastering File Operations in Python</a></li>
<li><a href="#_lab_functional_programming_in_python">Lab: Functional Programming in Python</a></li>
<li><a href="#_lab_functional_programming_in_python_case_driven">Lab: Functional Programming in Python (Case-Driven)</a></li>
<li><a href="#_case_study_functional_programming_for_bcbs_operations">Case Study: Functional Programming for BCBS Operations</a></li>
<li><a href="#_lab_object_oriented_programming_in_python">Lab: Object-Oriented Programming in Python</a></li>
<li><a href="#_lab_comprehensive_testing_in_python">Lab: Comprehensive Testing in Python</a></li>
<li><a href="#_lab_database_basics_with_python">Lab: Database Basics with Python</a></li>
<li><a href="#_lab_data_analytics_using_functional_programming">Lab: Data Analytics Using Functional Programming</a></li>
<li><a href="#_case_study_database_etl_and_analytics">Case Study: Database ETL and Analytics</a></li>
<li><a href="#_lab_logging_in_python">Lab: Logging in Python</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="progress-container">
    <div class="progress-track">
        <div class="progress-fill"></div>
    </div>
    <div class="progress-stats">
        <span>Exercises completed: 0/0</span>
        <span>0%</span>
    </div>
</div>

<link rel="stylesheet" href="styles.css">
<script src="script.js"></script>
</div>
</div>
<div class="sect1">
<h2 id="_lab_python_naming_conventions_and_pep8_guidelines">Lab: Python Naming Conventions and PEP8 Guidelines</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective">Objective</h3>
<div class="paragraph">
<p>Provide a comprehensive guide to naming conventions and coding standards in Python, focusing on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Rules for naming various coding artifacts.</p>
</li>
<li>
<p>PEP8 guidelines for maintaining clean and readable code.</p>
</li>
<li>
<p>Examples of best practices and common pitfalls.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_pep8">Step 1: Introduction to PEP8</h3>
<div class="paragraph">
<p>PEP8 is the official style guide for Python code. It provides conventions for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code layout.</p>
</li>
<li>
<p>Naming styles.</p>
</li>
<li>
<p>Indentation and line length.</p>
</li>
<li>
<p>Spacing, imports, and comments.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_naming_conventions">Step 2: Naming Conventions</h3>
<div class="sect3">
<h4 id="_variables_and_functions">Variables and Functions</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>snake_case</strong> for variable and function names.</p>
</li>
<li>
<p>Keep names descriptive and meaningful.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
policy_id = "POL12345"
def calculate_premium(base, risk_factor):
    return base * risk_factor

# Incorrect
PolicyId = "POL12345"
def CalculatePremium(Base, RiskFactor):
    return Base * RiskFactor</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constants">Constants</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>ALL_CAPS</strong> for constants.</p>
</li>
<li>
<p>Define constants at the top of the file or in a separate configuration file.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
MAX_PREMIUM_LIMIT = 10000
DEFAULT_POLICY_TYPE = "Life"

# Incorrect
maxPremiumLimit = 10000
defaultPolicyType = "Life"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_classes">Classes</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>CamelCase</strong> for class names.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
class InsurancePolicy:
    def __init__(self, policy_id, premium):
        self.policy_id = policy_id
        self.premium = premium

# Incorrect
class insurance_policy:
    def __init__(self, policy_id, premium):
        self.policy_id = policy_id
        self.premium = premium</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_methods">Methods</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>snake_case</strong> for method names within classes.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
class InsurancePolicy:
    def calculate_premium(self, base, risk_factor):
        return base * risk_factor

# Incorrect
class InsurancePolicy:
    def CalculatePremium(self, Base, RiskFactor):
        return Base * RiskFactor</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modules_and_packages">Modules and Packages</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>short_snake_case</strong> for module and package names.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
import policy_calculator

# Incorrect
import PolicyCalculator</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exceptions">Exceptions</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>CamelCase</strong> for exception class names, and suffix them with "Error."</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
class PolicyValidationError(Exception):
    pass

# Incorrect
class policy_validation_error(Exception):
    pass</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_pep8_guidelines">Step 3: PEP8 Guidelines</h3>
<div class="sect3">
<h4 id="_indentation">Indentation</h4>
<div class="ulist">
<ul>
<li>
<p>Use <strong>4 spaces per indentation level</strong>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
if premium &gt; 1000:
    print("High premium")

# Incorrect
if premium &gt; 1000:
	print("High premium")  # Tab instead of spaces</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_line_length">Line Length</h4>
<div class="ulist">
<ul>
<li>
<p>Limit lines to <strong>79 characters</strong>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
policy_description = (
    "This policy provides comprehensive coverage for individuals "
    "aged between 25 and 50 years."
)

# Incorrect
policy_description = "This policy provides comprehensive coverage for individuals aged between 25 and 50 years."</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spacing">Spacing</h4>
<div class="ulist">
<ul>
<li>
<p>Add a single space around operators and after commas.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
premium = base_premium * risk_factor

# Incorrect
premium=base_premium*risk_factor</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_imports">Imports</h4>
<div class="ulist">
<ul>
<li>
<p>Imports should be grouped as:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Standard library imports.</p>
</li>
<li>
<p>Related third-party imports.</p>
</li>
<li>
<p>Local application/library imports.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Each group should be separated by a blank line.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
import os
import sys

import pytest

from policy_calculator import calculate_premium

# Incorrect
import pytest, os, sys
from policy_calculator import calculate_premium</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_comments">Comments</h4>
<div class="ulist">
<ul>
<li>
<p>Use comments to explain <strong>why</strong>, not <strong>what</strong>.</p>
</li>
<li>
<p>Use <strong>#</strong> for inline comments and block comments.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Correct
# Calculate premium based on base amount and risk factor.
def calculate_premium(base, risk_factor):
    return base * risk_factor

# Incorrect
# This function calculates the premium.
def calculate_premium(base, risk_factor):
    return base * risk_factor</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_real_world_example">Step 4: Real-World Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Constants
MAX_PREMIUM_LIMIT = 10000
DEFAULT_POLICY_TYPE = "Life"

# Class definition
class InsurancePolicy:
    def __init__(self, policy_id, policy_type, premium):
        self.policy_id = policy_id
        self.policy_type = policy_type
        self.premium = premium

    def is_high_premium(self):
        return self.premium &gt; MAX_PREMIUM_LIMIT

# Function to calculate premium
def calculate_premium(base, risk_factor):
    return base * risk_factor

# Main workflow
if __name__ == "__main__":
    policy = InsurancePolicy("POL12345", DEFAULT_POLICY_TYPE, 12000)
    print(f"Policy ID: {policy.policy_id}, High Premium: {policy.is_high_premium()}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_summary">Step 5: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Follow PEP8 for consistent, clean, and readable Python code.</p>
</li>
<li>
<p>Use descriptive names for variables, functions, and classes.</p>
</li>
<li>
<p>Group and format imports properly.</p>
</li>
<li>
<p>Apply spacing, indentation, and line length guidelines effectively.</p>
</li>
<li>
<p>Use comments to clarify intent and avoid redundant explanations.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_understanding_data_types_sequence_types_and_pep_8_standards">Lab: Understanding Data Types, Sequence Types, and PEP 8 Standards</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_2">Objective</h3>
<div class="paragraph">
<p>Introduce beginners to Python programming with a focus on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Data types and their usage.</p>
</li>
<li>
<p>Sequence types (list, tuple, string, dictionary, and set).</p>
</li>
<li>
<p>Writing clean, readable code following PEP 8 standards.</p>
</li>
<li>
<p>Comparison of Python operations with SAS equivalents for better context.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_data_types">Step 1: Introduction to Data Types</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Python has dynamic typing, meaning variables do not need explicit type declarations.
# Common data types:

# Integer
age = 25  # Example of an integer

# Float
salary = 45750.75  # Example of a floating-point number

# String
name = "John Doe"  # Example of a string

# Boolean
is_employee = True  # Example of a boolean value

print("Age:", type(age))
print("Salary:", type(salary))
print("Name:", type(name))
print("Is Employee:", type(is_employee))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_data_types">SAS Comparison: Data Types</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses explicit typing for variables within data steps. */

DATA example;
    age = 25; /* Numeric variable */
    salary = 45750.75; /* Numeric variable */
    name = "John Doe"; /* Character variable */
    is_employee = 1; /* Numeric, often 0/1 for boolean-like operations */
RUN;

PROC PRINT DATA=example;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_sequence_types">Step 2: Sequence Types</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Python's sequence types are powerful and versatile.

# List: Mutable sequence of items
fruits = ["Apple", "Banana", "Cherry"]
fruits.append("Date")  # Add an item

# Tuple: Immutable sequence of items
coordinates = (34.0522, -118.2437)  # Latitude and longitude

# String: Immutable sequence of characters
message = "Hello, World!"
substring = message[0:5]  # Slicing strings

# Set: Unordered collection of unique items
unique_fruits = set(fruits)

# Dictionary: Key-value pairs
employee = {"name": "John Doe", "age": 25, "salary": 45750.75}

print("List:", fruits)
print("Tuple:", coordinates)
print("Substring:", substring)
print("Set:", unique_fruits)
print("Dictionary:", employee)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_sequence_types">SAS Comparison: Sequence Types</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS does not natively support sequence types like Python but achieves similar results with arrays or tables. */

/* Array in SAS */
DATA array_example;
    ARRAY fruits[4] $12 _TEMPORARY_ ("Apple", "Banana", "Cherry", "Date");
    DO i = 1 TO DIM(fruits);
        PUT fruits[i];
    END;
RUN;

/* Key-value structures in SAS can be approximated with hash objects. */
DATA _NULL_;
    DECLARE HASH employee();
    employee.DEFINEKEY("key");
    employee.DEFINEVALUE("value");
    employee.DEFINEDONE();
    employee.ADD(KEY:"name", VALUE:"John Doe");
    employee.ADD(KEY:"age", VALUE:25);
    employee.ADD(KEY:"salary", VALUE:45750.75);
    employee.OUTPUT(DATASET:"employee_data");
RUN;

PROC PRINT DATA=employee_data;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_writing_clean_code_with_pep_8">Step 3: Writing Clean Code with PEP 8</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Following PEP 8 ensures your Python code is readable and maintainable.

# Example of PEP 8-compliant code:
def calculate_bonus(salary, percentage):
    """Calculate bonus based on salary and percentage."""
    bonus = salary * (percentage / 100)
    return bonus

# Call the function
employee_bonus = calculate_bonus(salary=45750.75, percentage=10)
print(f"Bonus: ${employee_bonus:.2f}")

# Common PEP 8 Practices:
# 1. Use 4 spaces per indentation level.
# 2. Limit lines to 79 characters.
# 3. Use descriptive variable names.
# 4. Leave a blank line between functions or class definitions.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_code_readability">SAS Comparison: Code Readability</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS emphasizes proper indentation for readability, although it does not have strict style guides like PEP 8. */

%MACRO calculate_bonus(salary, percentage);
    %LET bonus = %SYSEVALF(&amp;salary * (&amp;percentage / 100));
    %PUT Bonus: &amp;bonus;
%MEND;

%calculate_bonus(45750.75, 10);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_summary">Step 4: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Python&#8217;s dynamic typing makes it easy to start with data types.</p>
</li>
<li>
<p>Sequence types provide powerful tools for organizing and manipulating data.</p>
</li>
<li>
<p>PEP 8 guidelines help ensure your code is clean, readable, and maintainable.</p>
</li>
<li>
<p>SAS provides comparable functionality but often requires explicit setups, such as arrays or hash objects, to achieve similar results.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_looping_branching_and_advanced_sequence_operations_in_python">Lab: Looping, Branching, and Advanced Sequence Operations in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_3">Objective</h3>
<div class="paragraph">
<p>Introduce beginners to Python with examples focused on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Looping constructs (for, while, etc.).</p>
</li>
<li>
<p>Branching (if-else, nested conditions).</p>
</li>
<li>
<p>Advanced sequence operations (list comprehensions, dictionary comprehensions, and set operations).</p>
</li>
<li>
<p>Comparison of Python operations with SAS equivalents for an insurance domain.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_insurance_domain_scenario">Insurance Domain Scenario</h3>
<div class="paragraph">
<p>Analyze insurance claims data and apply Python operations for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Filtering high-risk claims.</p>
</li>
<li>
<p>Calculating claim totals.</p>
</li>
<li>
<p>Identifying unique insurance categories.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_looping_in_python">Step 1: Looping in Python</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Calculating total claims using a loop
claims = [1500, 2000, 3000, 4500, 5000]

# For loop to calculate total
total_claims = 0
for claim in claims:
    total_claims += claim

print("Total Claims:", total_claims)

# While loop to find the first claim exceeding a threshold
threshold = 4000
index = 0
while index &lt; len(claims):
    if claims[index] &gt; threshold:
        print("First high claim:", claims[index])
        break
    index += 1

# Nested loop to calculate claim totals for different risk levels
risk_levels = {"High": [12000, 15000], "Medium": [5000, 8000], "Low": [1500, 2000]}
total_per_risk = {}
for risk, amounts in risk_levels.items():
    total_per_risk[risk] = sum(amounts)

print("Total per risk level:", total_per_risk)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_looping">SAS Comparison: Looping</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses DO loops for similar operations. */

DATA _NULL_;
    ARRAY claims[5] (1500 2000 3000 4500 5000);
    total_claims = 0;
    DO i = 1 TO DIM(claims);
        total_claims + claims[i];
    END;
    PUT "Total Claims: " total_claims;

    /* Find first claim exceeding threshold */
    DO i = 1 TO DIM(claims);
        IF claims[i] &gt; 4000 THEN DO;
            PUT "First high claim: " claims[i];
            LEAVE;
        END;
    END;

    /* Nested loop for risk levels */
    ARRAY high[2] (12000 15000);
    ARRAY medium[2] (5000 8000);
    ARRAY low[2] (1500 2000);
    total_high = 0; total_medium = 0; total_low = 0;

    DO i = 1 TO DIM(high);
        total_high + high[i];
    END;

    DO i = 1 TO DIM(medium);
        total_medium + medium[i];
    END;

    DO i = 1 TO DIM(low);
        total_low + low[i];
    END;

    PUT "Total High Risk: " total_high;
    PUT "Total Medium Risk: " total_medium;
    PUT "Total Low Risk: " total_low;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_branching_in_python">Step 2: Branching in Python</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Classifying claims based on amount
claim_amounts = [1500, 2000, 5000, 12000, 800]

for claim in claim_amounts:
    if claim &gt; 10000:
        print(f"Claim ${claim} is categorized as High Risk.")
    elif claim &gt; 3000:
        print(f"Claim ${claim} is categorized as Medium Risk.")
    else:
        print(f"Claim ${claim} is categorized as Low Risk.")

# Nested branching for additional categorization
for claim in claim_amounts:
    if claim &gt; 10000:
        if claim &gt; 20000:
            print(f"Claim ${claim} is categorized as Critical High Risk.")
        else:
            print(f"Claim ${claim} is categorized as High Risk.")
    elif claim &gt; 3000:
        print(f"Claim ${claim} is categorized as Medium Risk.")
    else:
        print(f"Claim ${claim} is categorized as Low Risk.")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_branching">SAS Comparison: Branching</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses IF-THEN-ELSE for similar branching logic. */

DATA claims_classification;
    INPUT claim_amount;
    IF claim_amount &gt; 10000 THEN DO;
        IF claim_amount &gt; 20000 THEN risk = "Critical High Risk";
        ELSE risk = "High Risk";
    END;
    ELSE IF claim_amount &gt; 3000 THEN risk = "Medium Risk";
    ELSE risk = "Low Risk";
    DATALINES;
    1500
    2000
    5000
    12000
    800
    ;
RUN;

PROC PRINT DATA=claims_classification;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_advanced_sequence_operations">Step 3: Advanced Sequence Operations</h3>
<div class="sect3">
<h4 id="_list_comprehensions">List Comprehensions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Identify high-risk claims with list comprehension
claims = [1500, 2000, 5000, 12000, 800]
high_risk_claims = [claim for claim in claims if claim &gt; 10000]
print("High Risk Claims:", high_risk_claims)

# Nested comprehension for risk classification
risk_classification = [
    "Critical High Risk" if claim &gt; 20000 else "High Risk" if claim &gt; 10000 else "Medium Risk" if claim &gt; 3000 else "Low Risk"
    for claim in claims
]
print("Risk Classification:", risk_classification)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dictionary_comprehensions">Dictionary Comprehensions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Map claim IDs to their categories
claim_data = {
    101: 1500,
    102: 2000,
    103: 5000,
    104: 12000,
    105: 800,
}

claim_categories = {
    claim_id: "Critical High Risk" if amount &gt; 20000 else "High Risk" if amount &gt; 10000 else "Medium Risk" if amount &gt; 3000 else "Low Risk"
    for claim_id, amount in claim_data.items()
}
print("Claim Categories:", claim_categories)

# Nested dictionary for claim details
claim_details = {
    claim_id: {"amount": amount, "risk": "High Risk" if amount &gt; 10000 else "Medium Risk" if amount &gt; 3000 else "Low Risk"}
    for claim_id, amount in claim_data.items()
}
print("Claim Details:", claim_details)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_set_operations">Set Operations</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Identify unique categories of claims
categories = ["Low Risk", "Medium Risk", "High Risk", "Critical High Risk", "Low Risk"]
unique_categories = set(categories)
print("Unique Categories:", unique_categories)

# Find common categories across different datasets
dataset1 = {"Low Risk", "Medium Risk"}
dataset2 = {"Medium Risk", "High Risk"}
common_categories = dataset1.intersection(dataset2)
print("Common Categories:", common_categories)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_advanced_operations">SAS Comparison: Advanced Operations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* List comprehensions can be simulated with WHERE clauses or arrays. */

DATA high_risk_claims;
    SET claims_classification;
    WHERE risk = "High Risk";
RUN;

/* Nested logic for classification */
PROC FORMAT;
    VALUE riskfmt
        0 - 3000 = "Low Risk"
        3001 - 10000 = "Medium Risk"
        10001 - 20000 = "High Risk"
        20001 - HIGH = "Critical High Risk";
RUN;

DATA claims_mapped;
    SET claims_classification;
    risk_category = PUT(claim_amount, riskfmt.);
RUN;

PROC PRINT DATA=claims_mapped;
RUN;

/* Set operations are not directly supported but can be approximated using PROC SORT and NODUPKEY. */
DATA unique_categories;
    SET claims_classification;
    BY risk;
    IF FIRST.risk;
RUN;

PROC PRINT DATA=unique_categories;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_summary_2">Step 4: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Python&#8217;s looping and branching constructs provide flexibility for processing data efficiently.</p>
</li>
<li>
<p>Advanced sequence operations like comprehensions make Python ideal for data manipulation.</p>
</li>
<li>
<p>SAS achieves similar results but often requires more explicit configuration.</p>
</li>
<li>
<p>Using examples from the insurance domain helps solidify these programming concepts for real-world applications.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_detailed_string_operations_in_python">Lab: Detailed String Operations in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_4">Objective</h3>
<div class="paragraph">
<p>Introduce beginners to Python string operations by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Exploring basic and advanced string functions.</p>
</li>
<li>
<p>Writing clean and efficient string manipulation code.</p>
</li>
<li>
<p>Comparing Python string operations with SAS equivalents.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_management">Scenario: Insurance Policy Management</h3>
<div class="paragraph">
<p>Analyze and manipulate strings representing insurance policy data, including policy IDs, holder names, and descriptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_basic_string_operations">Step 1: Basic String Operations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example data
policy_id = "POL12345"
policy_holder = "John Doe"
description = "Premium insurance policy for vehicle protection."

# Length of strings
print("Length of Policy ID:", len(policy_id))
print("Length of Description:", len(description))

# String indexing and slicing
print("First character of Policy ID:", policy_id[0])
print("Last character of Policy ID:", policy_id[-1])
print("Slice of Description (0-7):", description[0:7])

# String concatenation
full_name = policy_holder.split()[0] + " " + policy_holder.split()[1]
print("Full Name:", full_name)

# String repetition
separator = "-" * 10
print("Separator:", separator)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_basic_string_operations">SAS Comparison: Basic String Operations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses functions like LENGTH, SUBSTR, and CATX for string operations. */
DATA policy_example;
    policy_id = "POL12345";
    policy_holder = "John Doe";
    description = "Premium insurance policy for vehicle protection.";

    /* Length of strings */
    policy_id_length = LENGTH(policy_id);
    description_length = LENGTH(description);

    /* Substring operations */
    first_char = SUBSTR(policy_id, 1, 1);
    last_char = SUBSTR(policy_id, LENGTH(policy_id), 1);
    slice_desc = SUBSTR(description, 1, 7);

    /* Concatenation */
    full_name = CATX(" ", SCAN(policy_holder, 1), SCAN(policy_holder, 2));

    /* Repetition */
    separator = REPEAT("-", 10);
RUN;

PROC PRINT DATA=policy_example;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_advanced_string_operations">Step 2: Advanced String Operations</h3>
<div class="sect3">
<h4 id="_string_methods">String Methods</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># String case transformations
print("Uppercase Policy Holder:", policy_holder.upper())
print("Lowercase Description:", description.lower())

# String replacement
updated_description = description.replace("vehicle", "car")
print("Updated Description:", updated_description)

# String splitting and joining
words = description.split()
print("Words in Description:", words)
joined_description = " ".join(words)
print("Joined Description:", joined_description)

# Checking string properties
print("Is Policy ID alphanumeric?:", policy_id.isalnum())
print("Does Description start with 'Premium'?:", description.startswith("Premium"))
print("Does Description end with 'protection.'?:", description.endswith("protection."))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_advanced_string_operations">SAS Comparison: Advanced String Operations</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS provides functions like UPCASE, LOWCASE, TRANWRD, SCAN, and INDEX for similar operations. */
DATA advanced_string_example;
    policy_id = "POL12345";
    policy_holder = "John Doe";
    description = "Premium insurance policy for vehicle protection.";

    /* Case transformations */
    uppercase_holder = UPCASE(policy_holder);
    lowercase_desc = LOWCASE(description);

    /* Replacement */
    updated_description = TRANWRD(description, "vehicle", "car");

    /* Splitting and joining */
    first_word = SCAN(description, 1, " ");
    second_word = SCAN(description, 2, " ");
    joined_desc = CATX(" ", first_word, second_word);

    /* Checking properties */
    starts_with_premium = INDEX(description, "Premium") = 1;
    ends_with_protection = SUBSTR(description, LENGTH(description) - 9) = "protection.";
RUN;

PROC PRINT DATA=advanced_string_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_regular_expressions_for_string_operations">Step 3: Regular Expressions for String Operations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import re

# Find all numeric parts in a string
policy_number = re.findall(r"\d+", policy_id)
print("Policy Number Extracted:", policy_number)

# Validate policy format
is_valid_policy = bool(re.match(r"POL\d{5}$", policy_id))
print("Is Policy ID Valid?:", is_valid_policy)

# Replace multiple spaces with a single space
messy_description = "Premium   insurance   policy    for  vehicle   protection."
cleaned_description = re.sub(r"\s+", " ", messy_description)
print("Cleaned Description:", cleaned_description)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_regular_expressions">SAS Comparison: Regular Expressions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS supports PRXMATCH and PRXCHANGE for regular expressions. */
DATA regex_example;
    policy_id = "POL12345";
    messy_description = "Premium   insurance   policy    for  vehicle   protection.";

    /* Find numeric parts */
    IF PRXMATCH("/POL\d{5}/", policy_id) THEN valid_policy = 1;
    ELSE valid_policy = 0;

    /* Replace multiple spaces */
    cleaned_description = PRXCHANGE("s/\s+/ /", -1, messy_description);
RUN;

PROC PRINT DATA=regex_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_summary_3">Step 4: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Python provides versatile tools for string manipulation, including basic and advanced operations.</p>
</li>
<li>
<p>Regular expressions add flexibility for pattern matching and validation.</p>
</li>
<li>
<p>SAS offers similar functionality but often requires explicit function calls for operations.</p>
</li>
<li>
<p>Using insurance-related examples helps contextualize these operations for practical use.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_comprehensive_exception_handling_in_python_insurance_domain">Lab: Comprehensive Exception Handling in Python (Insurance Domain)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_5">Objective</h3>
<div class="paragraph">
<p>Provide a detailed overview of Python&#8217;s exception handling mechanism by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introducing core exception handling concepts.</p>
</li>
<li>
<p>Demonstrating common exception types and custom exceptions.</p>
</li>
<li>
<p>Highlighting advanced techniques like logging and re-raising exceptions.</p>
</li>
<li>
<p>Comparing Python&#8217;s approach with SAS error-handling techniques.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_validation">Scenario: Insurance Policy and Claims Validation</h3>
<div class="paragraph">
<p>Handle exceptions during data processing, validation of claims, and file handling in the context of an insurance system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_basics_of_exception_handling">Step 1: Basics of Exception Handling</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Basic exception handling during claim amount processing
claims = [2000, 4500, "invalid", 3000, -1000]

for claim in claims:
    try:
        # Ensure claim is a valid positive number
        if not isinstance(claim, (int, float)):
            raise ValueError(f"Claim must be a number. Invalid claim value provided: {claim}")
        if claim &lt;= 0:
            raise ValueError(f"Claim value must be positive. Provided: {claim}")
        print(f"Processed claim: ${claim}")
    except ValueError as e:
        print(f"Error: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_error_handling">SAS Comparison: Error Handling</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses conditional checks to handle errors. */
DATA claims_handling;
    INPUT claim_amount : $10.;
    IF NOT (claim_amount &gt; 0) THEN DO;
        PUT "Error: Invalid or negative claim value " claim_amount;
    END;
    ELSE PUT "Processed claim: " claim_amount;
    DATALINES;
    2000
    4500
    invalid
    3000
    -1000
    ;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_handling_multiple_exceptions">Step 2: Handling Multiple Exceptions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: File handling with multiple exception types
try:
    with open("policy_data.txt", "r", encoding="utf-8") as file:
        data = file.read()
        print("File content:", data)
except FileNotFoundError:
    print("Error: File not found.")
except PermissionError:
    print("Error: Permission denied.")
except UnicodeDecodeError:
    print("Error: Unable to decode the file with the specified encoding.")
except Exception as e:
    print(f"An unexpected error occurred: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_file_handling">SAS Comparison: File Handling</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses conditional checks for file existence and permissions. */
FILENAME policy_data "policy_data.txt";
DATA _NULL_;
    INFILE policy_data;
    INPUT;
    FILE_EXISTS = (FILEREF("policy_data") = 0);
    IF NOT FILE_EXISTS THEN PUT "Error: File not found.";
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_custom_exceptions">Step 3: Custom Exceptions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Define a custom exception for claim validation
class ClaimValidationError(Exception):
    pass

# Example: Using the custom exception
claims = [2000, 4500, "invalid", 3000, -1000]

def validate_claim(claim):
    if not isinstance(claim, (int, float)):
        raise ClaimValidationError(f"Claim must be a number. Invalid claim value provided: {claim}")
    if claim &lt;= 0:
        raise ClaimValidationError(f"Claim value must be positive. Provided: {claim}")

for claim in claims:
    try:
        validate_claim(claim)
        print(f"Valid claim: ${claim}")
    except ClaimValidationError as e:
        print(f"Claim Validation Error: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_advanced_techniques">Step 4: Advanced Techniques</h3>
<div class="sect3">
<h4 id="_logging_exceptions">Logging Exceptions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import logging

# Configure logging
log_file_path = "errors.log"  # Configurable log file path
logging.basicConfig(level=logging.ERROR, filename=log_file_path)

# Example: Logging exceptions
for claim in claims:
    try:
        validate_claim(claim)
        print(f"Valid claim: ${claim}")
    except ClaimValidationError as e:
        logging.error(f"Error processing claim {claim}: {e}")
        print(f"Error logged: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_re_raising_exceptions">Re-raising Exceptions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Re-raising exceptions after logging
try:
    validate_claim("invalid")
except ClaimValidationError as e:
    logging.error(f"Critical error: {e}")
    raise</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sas_comparison_logging_and_advanced_handling">SAS Comparison: Logging and Advanced Handling</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS does not have direct logging but uses PUT statements for error tracking. */
DATA _NULL_;
    FILE LOG;
    PUT "Error: Invalid claim value.";
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_ensuring_cleanup_with_finally">Step 5: Ensuring Cleanup with <code>finally</code></h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Ensuring cleanup with `finally`
try:
    with open("policy_data.txt", "r", encoding="utf-8") as file:
        data = file.read()
        print("File content:", data)
except FileNotFoundError:
    print("Error: File not found.")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_summary">Step 6: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Python&#8217;s exception handling provides flexibility through <code>try</code>, <code>except</code>, <code>else</code>, and <code>finally</code> blocks.</p>
</li>
<li>
<p>Custom exceptions enable domain-specific error handling.</p>
</li>
<li>
<p>Advanced techniques like logging and re-raising improve robustness.</p>
</li>
<li>
<p>SAS relies on conditional checks and PUT statements for error handling, offering limited flexibility compared to Python.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_advanced_datetime_operations_in_python">Lab: Advanced DateTime Operations in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_6">Objective</h3>
<div class="paragraph">
<p>Introduce beginners to Python&#8217;s <code>datetime</code> module through a detailed exploration of:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Core <code>datetime</code> classes (<code>datetime</code>, <code>date</code>, <code>time</code>, <code>timedelta</code>, <code>timezone</code>).</p>
</li>
<li>
<p>Operations like parsing, formatting, and calculations.</p>
</li>
<li>
<p>Handling time zones.</p>
</li>
<li>
<p>Comparing Python operations with SAS equivalents.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_processing">Scenario: Insurance Policy and Claims Processing</h3>
<div class="paragraph">
<p>Analyze and manipulate date and time data related to insurance policy issuance, claims submissions, and premium due dates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_understanding_core_classes">Step 1: Understanding Core Classes</h3>
<div class="sect3">
<h4 id="_datetime_date_class"><code>datetime.date</code> Class</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from datetime import date

# Example: Policy issuance date
policy_issued = date(2023, 7, 15)
print("Policy Issued Date:", policy_issued)

# Accessing components
print("Year:", policy_issued.year)
print("Month:", policy_issued.month)
print("Day:", policy_issued.day)

# Calculating days since policy issuance
today = date.today()
days_since_issue = (today - policy_issued).days
print("Days Since Policy Issuance:", days_since_issue)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_date">SAS Comparison: <code>date</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses numeric variables with DATE format for date operations. */
DATA policy_dates;
    policy_issued = "15JUL2023"D;
    today = TODAY();
    days_since_issue = today - policy_issued;
    FORMAT policy_issued DATE9. today DATE9.;
RUN;

PROC PRINT DATA=policy_dates;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datetime_time_class"><code>datetime.time</code> Class</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from datetime import time

# Example: Claims submission time
submission_time = time(14, 30, 0)  # 2:30 PM
print("Submission Time:", submission_time)

# Accessing components
print("Hour:", submission_time.hour)
print("Minute:", submission_time.minute)
print("Second:", submission_time.second)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_time">SAS Comparison: <code>time</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses numeric variables with TIME format for time operations. */
DATA submission_times;
    submission_time = "14:30:00"T;
    FORMAT submission_time TIME8.;
RUN;

PROC PRINT DATA=submission_times;
RUN;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datetime_datetime_class"><code>datetime.datetime</code> Class</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from datetime import datetime

# Example: Policy creation timestamp
policy_creation = datetime(2023, 7, 15, 14, 30, 0)
print("Policy Creation Timestamp:", policy_creation)

# Accessing components
print("Year:", policy_creation.year)
print("Hour:", policy_creation.hour)
print("Second:", policy_creation.second)

# Difference between two datetime objects
claim_submission = datetime(2023, 7, 20, 10, 15, 0)
time_to_submit = claim_submission - policy_creation
print("Time to Submit Claim:", time_to_submit)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_datetime">SAS Comparison: <code>datetime</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS combines date and time using the DATETIME format. */
DATA datetime_example;
    policy_creation = DHMS("15JUL2023"D, 14, 30, 0);
    claim_submission = DHMS("20JUL2023"D, 10, 15, 0);
    time_to_submit = claim_submission - policy_creation;
    FORMAT policy_creation DATETIME20. claim_submission DATETIME20.;
RUN;

PROC PRINT DATA=datetime_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_advanced_operations_with_timedelta">Step 2: Advanced Operations with <code>timedelta</code></h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from datetime import timedelta

# Adding a grace period to premium due date
premium_due = policy_issued + timedelta(days=30)
grace_period_end = premium_due + timedelta(days=15)
print("Premium Due Date:", premium_due)
print("Grace Period End Date:", grace_period_end)

# Calculating time differences
policy_duration = timedelta(days=365)
expiry_date = policy_issued + policy_duration
print("Policy Expiry Date:", expiry_date)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_timedelta">SAS Comparison: <code>timedelta</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses direct date arithmetic for timedelta operations. */
DATA timedelta_example;
    policy_issued = "15JUL2023"D;
    premium_due = policy_issued + 30;
    grace_period_end = premium_due + 15;
    policy_expiry = policy_issued + 365;
    FORMAT policy_issued premium_due grace_period_end policy_expiry DATE9.;
RUN;

PROC PRINT DATA=timedelta_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_handling_time_zones">Step 3: Handling Time Zones</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from datetime import timezone, timedelta

# Example: Policy issuance in a specific timezone
policy_timezone = timezone(timedelta(hours=-5))  # UTC-5
policy_creation_utc = datetime(2023, 7, 15, 14, 30, 0, tzinfo=policy_timezone)
print("Policy Creation with Timezone:", policy_creation_utc)

# Converting to UTC
policy_creation_converted = policy_creation_utc.astimezone(timezone.utc)
print("Policy Creation in UTC:", policy_creation_converted)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_time_zones">SAS Comparison: Time Zones</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS does not directly support time zones; custom calculations are required. */
DATA timezone_example;
    policy_creation = DHMS("15JUL2023"D, 14, 30, 0) - 5*3600; /* UTC-5 */
    FORMAT policy_creation DATETIME20.;
RUN;

PROC PRINT DATA=timezone_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_parsing_and_formatting_dates">Step 4: Parsing and Formatting Dates</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Parsing strings to datetime objects
date_string = "2023-07-15 14:30:00"
parsed_date = datetime.strptime(date_string, "%Y-%m-%d %H:%M:%S")
print("Parsed Date:", parsed_date)

# Formatting datetime objects to strings
formatted_date = parsed_date.strftime("%A, %d %B %Y %I:%M %p")
print("Formatted Date:", formatted_date)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_sas_comparison_parsing_and_formatting">SAS Comparison: Parsing and Formatting</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sas" data-lang="sas">/* SAS uses INPUT and PUT functions for parsing and formatting. */
DATA parse_format_example;
    date_string = "15JUL2023 14:30:00";
    parsed_date = INPUT(date_string, DATETIME20.);
    formatted_date = PUT(parsed_date, WORDDATX20.);
RUN;

PROC PRINT DATA=parse_format_example;
RUN;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_summary_2">Step 5: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Python&#8217;s <code>datetime</code> module provides extensive support for date and time operations.</p>
</li>
<li>
<p>Key classes include <code>date</code>, <code>time</code>, <code>datetime</code>, <code>timedelta</code>, and <code>timezone</code>.</p>
</li>
<li>
<p>Operations like parsing, formatting, and time zone handling are intuitive.</p>
</li>
<li>
<p>SAS provides comparable functionality through formats and date/time functions but lacks direct support for time zones.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_comprehensive_guide_to_python_functions">Lab: Comprehensive Guide to Python Functions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_7">Objective</h3>
<div class="paragraph">
<p>Explore all aspects of Python functions by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Understanding function definitions and types.</p>
</li>
<li>
<p>Exploring arguments, return values, and scope.</p>
</li>
<li>
<p>Demonstrating advanced topics like decorators, lambda functions, and recursion.</p>
</li>
<li>
<p>Applying these concepts in a real-world insurance domain scenario.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_processing_2">Scenario: Insurance Policy and Claims Processing</h3>
<div class="paragraph">
<p>Develop a Python-based system to process insurance claims, calculate premiums, and validate policy details using functions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_basics_of_function_definition">Step 1: Basics of Function Definition</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function to calculate monthly premium

def calculate_premium(base_amount, risk_factor):
    """
    Calculate the monthly premium based on a base amount and risk factor.
    Arguments:
        base_amount (float): The base premium amount.
        risk_factor (float): The risk multiplier (e.g., 1.2 for medium risk).
    Returns:
        float: The calculated monthly premium.
    """
    return base_amount * risk_factor

# Function call
premium = calculate_premium(500, 1.5)
print(f"Calculated Premium: ${premium:.2f}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_positional_and_keyword_arguments">Step 2: Positional and Keyword Arguments</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function to validate a policy

def validate_policy(policy_id, policy_holder, *, active=True):
    """
    Validate the details of an insurance policy.
    Arguments:
        policy_id (str): The policy identifier.
        policy_holder (str): The policyholder's name.
        active (bool): Whether the policy is active (default: True).
    Returns:
        str: Validation result message.
    """
    if not policy_id or not policy_holder:
        return "Policy validation failed: Missing details."
    if not active:
        return "Policy validation failed: Policy is inactive."
    return "Policy validation successful."

# Function calls
print(validate_policy("POL12345", "John Doe", active=True))
print(validate_policy("POL12345", "", active=False))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_default_and_variable_length_arguments">Step 3: Default and Variable-Length Arguments</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function to calculate total claims with variable-length arguments

def calculate_total_claims(base_claim, *additional_claims, **adjustments):
    """
    Calculate the total claim amount, including adjustments.
    Arguments:
        base_claim (float): The base claim amount.
        *additional_claims (float): Additional claims to include.
        **adjustments (float): Adjustments to apply (e.g., discounts, penalties).
    Returns:
        float: The total claim amount after adjustments.
    """
    total = base_claim + sum(additional_claims)
    for key, value in adjustments.items():
        if key == "discount":
            total -= value
        elif key == "penalty":
            total += value
    return total

# Function call
print(calculate_total_claims(1000, 200, 300, discount=150, penalty=50))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_scope_and_closures">Step 4: Scope and Closures</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function demonstrating closures

def policy_discount(discount_rate):
    """
    Create a function to calculate discounts for a given rate.
    Arguments:
        discount_rate (float): The discount rate as a percentage.
    Returns:
        function: A closure that calculates discounts.
    """
    def apply_discount(amount):
        return amount - (amount * discount_rate / 100)
    return apply_discount

# Using the closure
gold_policy_discount = policy_discount(20)  # 20% discount
gold_policy_total = gold_policy_discount(1500)
print(f"Gold Policy Total after Discount: ${gold_policy_total:.2f}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_lambda_functions">Step 5: Lambda Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Lambda function for quick claim approvals
quick_approval = lambda claim_amount: claim_amount &lt; 5000

# Using the lambda function
print("Claim Approved:" if quick_approval(4500) else "Claim Denied")
print("Claim Approved:" if quick_approval(5500) else "Claim Denied")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_decorators">Step 6: Decorators</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Decorator for logging function calls

def log_function_call(func):
    """
    Decorator to log the details of a function call.
    """
    def wrapper(*args, **kwargs):
        print(f"Calling function '{func.__name__}' with arguments {args} and {kwargs}")
        result = func(*args, **kwargs)
        print(f"Function '{func.__name__}' returned {result}")
        return result
    return wrapper

@log_function_call
def calculate_claim(claim_amount, penalty=0):
    return claim_amount + penalty

# Function call
calculate_claim(3000, penalty=100)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_recursion">Step 7: Recursion</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Recursive function to calculate policy tier benefits

def calculate_tier_benefits(tier, base_benefit=1000):
    """
    Recursively calculate benefits for multiple tiers.
    Arguments:
        tier (int): The tier level (e.g., 1 for basic, 3 for premium).
        base_benefit (float): The base benefit amount.
    Returns:
        float: Total benefits for the tier.
    """
    if tier == 1:
        return base_benefit
    return base_benefit + calculate_tier_benefits(tier - 1, base_benefit * 1.5)

# Function call
print(f"Total Benefits for Tier 3: ${calculate_tier_benefits(3):.2f}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_summary">Step 8: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Functions in Python provide a powerful way to organize code for reusability and clarity.</p>
</li>
<li>
<p>Advanced features like closures, decorators, and recursion enable flexible and concise solutions.</p>
</li>
<li>
<p>The insurance domain use case highlights practical applications of these concepts.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_mastering_lambda_functions_in_python_insurance_domain">Lab: Mastering Lambda Functions in Python (Insurance Domain)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_8">Objective</h3>
<div class="paragraph">
<p>Provide a comprehensive guide to Python lambda functions by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Understanding lambda syntax and use cases.</p>
</li>
<li>
<p>Exploring advanced operations with <code>map</code>, <code>filter</code>, <code>reduce</code>, and <code>sorted</code>.</p>
</li>
<li>
<p>Applying these concepts to an insurance domain case study.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_processing_3">Scenario: Insurance Policy and Claims Processing</h3>
<div class="paragraph">
<p>Use lambda functions to process policy data, calculate claims, and filter policies based on risk and premium levels.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_lambda_functions">Step 1: Introduction to Lambda Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Basic lambda function to calculate premium multiplier
premium_multiplier = lambda risk_factor: risk_factor * 1.1

# Using the lambda function
print(f"Premium Multiplier for Risk Factor 1.2: {premium_multiplier(1.2):.2f}")
print(f"Premium Multiplier for Risk Factor 1.5: {premium_multiplier(1.5):.2f}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_using_map_for_data_transformation">Step 2: Using <code>map</code> for Data Transformation</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Applying `map` to calculate premiums for multiple policies
base_premiums = [1000, 1200, 1500, 2000]
risk_factors = [1.1, 1.2, 1.5, 1.8]

# Use map with a lambda function to calculate final premiums
final_premiums = list(map(lambda base, risk: base * risk, base_premiums, risk_factors))

print("Final Premiums:", final_premiums)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_explanation">Explanation</h4>
<div class="ulist">
<ul>
<li>
<p><code>map</code> applies the lambda function to each element in the input iterables.</p>
</li>
<li>
<p>In this case, it multiplies each base premium by its corresponding risk factor.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_using_filter_for_data_filtering">Step 3: Using <code>filter</code> for Data Filtering</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Filtering policies with premiums above a threshold
threshold = 1500

# Use filter with a lambda function to select policies above the threshold
high_premium_policies = list(filter(lambda premium: premium &gt; threshold, final_premiums))

print("High Premium Policies:", high_premium_policies)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_explanation_2">Explanation</h4>
<div class="ulist">
<ul>
<li>
<p><code>filter</code> applies the lambda function as a condition and returns elements that evaluate to <code>True</code>.</p>
</li>
<li>
<p>Here, it filters out premiums that are below or equal to the threshold.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_using_reduce_for_aggregation">Step 4: Using <code>reduce</code> for Aggregation</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from functools import reduce

# Example: Calculating the total premium using `reduce`
total_premium = reduce(lambda x, y: x + y, final_premiums)

print("Total Premium Collected:", total_premium)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_explanation_3">Explanation</h4>
<div class="ulist">
<ul>
<li>
<p><code>reduce</code> applies the lambda function cumulatively to the items of the iterable.</p>
</li>
<li>
<p>Here, it sums up all premiums to calculate the total.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_using_sorted_with_a_lambda_function">Step 5: Using <code>sorted</code> with a Lambda Function</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Sorting policies by premium in descending order
sorted_policies = sorted(final_premiums, key=lambda premium: premium, reverse=True)

print("Policies Sorted by Premium (Descending):", sorted_policies)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_explanation_4">Explanation</h4>
<div class="ulist">
<ul>
<li>
<p><code>sorted</code> uses the lambda function as a key to determine the sorting order.</p>
</li>
<li>
<p>The <code>reverse=True</code> argument sorts the values in descending order.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_combining_map_filter_and_reduce">Step 6: Combining <code>map</code>, <code>filter</code>, and <code>reduce</code></h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Complex pipeline for policy processing
base_premiums = [1000, 1200, 1500, 2000]
risk_factors = [1.1, 1.2, 1.5, 1.8]

# Step 1: Calculate final premiums
final_premiums = list(map(lambda base, risk: base * risk, base_premiums, risk_factors))

# Step 2: Filter high premiums
high_premium_policies = list(filter(lambda premium: premium &gt; 1500, final_premiums))

# Step 3: Calculate total of high premiums
total_high_premium = reduce(lambda x, y: x + y, high_premium_policies)

print("High Premium Policies:", high_premium_policies)
print("Total of High Premium Policies:", total_high_premium)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_real_world_example_claim_processing_pipeline">Step 7: Real-World Example: Claim Processing Pipeline</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Processing claim amounts with map, filter, and reduce
claim_amounts = [500, 3000, 7000, 1500, 2000]

# Step 1: Apply a risk multiplier to all claims
adjusted_claims = list(map(lambda claim: claim * 1.2, claim_amounts))

# Step 2: Filter claims above a threshold
significant_claims = list(filter(lambda claim: claim &gt; 3000, adjusted_claims))

# Step 3: Calculate the total payout for significant claims
total_payout = reduce(lambda x, y: x + y, significant_claims)

print("Adjusted Claims:", adjusted_claims)
print("Significant Claims:", significant_claims)
print("Total Payout for Significant Claims:", total_payout)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_summary_2">Step 8: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Lambda functions provide concise, inline solutions for single-use operations.</p>
</li>
<li>
<p><code>map</code>, <code>filter</code>, <code>reduce</code>, and <code>sorted</code> enable efficient data transformations and aggregations.</p>
</li>
<li>
<p>Combining these tools creates powerful pipelines for real-world applications, as demonstrated in the insurance domain.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_mastering_lists_and_tuples_in_python">Lab: Mastering Lists and Tuples in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_9">Objective</h3>
<div class="paragraph">
<p>Provide a detailed exploration of Python lists and tuples by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Understanding their definitions and differences.</p>
</li>
<li>
<p>Demonstrating core functionalities with examples.</p>
</li>
<li>
<p>Applying advanced operations.</p>
</li>
<li>
<p>Using real-world scenarios in the insurance domain.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_data_management">Scenario: Insurance Policy and Claims Data Management</h3>
<div class="paragraph">
<p>Manage and manipulate insurance policies and claims data effectively using lists and tuples.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_lists_and_tuples">Step 1: Introduction to Lists and Tuples</h3>
<div class="sect3">
<h4 id="_list_basics">List Basics</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: List of policy IDs
policy_ids = ["POL12345", "POL12346", "POL12347"]

# Adding a new policy ID
policy_ids.append("POL12348")

# Removing a policy ID
policy_ids.remove("POL12345")

# Accessing elements
print("First Policy ID:", policy_ids[0])
print("All Policy IDs:", policy_ids)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tuple_basics">Tuple Basics</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Tuple of risk categories
risk_categories = ("Low", "Medium", "High")

# Accessing elements
print("First Risk Category:", risk_categories[0])
print("All Risk Categories:", risk_categories)

# Attempting to modify a tuple (this will raise an error)
try:
    risk_categories[0] = "Very Low"
except TypeError as e:
    print("Error:", e)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_key_differences">Key Differences</h4>
<div class="ulist">
<ul>
<li>
<p>Lists are mutable; tuples are immutable.</p>
</li>
<li>
<p>Tuples use less memory and are faster for fixed data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_common_operations_on_lists">Step 2: Common Operations on Lists</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Managing a list of claim amounts
claim_amounts = [1500, 2500, 3500, 4500, 5500]

# Adding claims
claim_amounts.append(6500)

# Inserting a claim at a specific position
claim_amounts.insert(2, 3000)

# Removing claims
claim_amounts.pop(1)  # Removes the second claim

# Sorting claims
claim_amounts.sort(reverse=True)  # Descending order

print("Claim Amounts:", claim_amounts)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_common_operations_on_tuples">Step 3: Common Operations on Tuples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Tuple of policy types
policy_types = ("Life", "Health", "Vehicle", "Property")

# Counting occurrences
print("Occurrences of 'Health':", policy_types.count("Health"))

# Finding an index
print("Index of 'Vehicle':", policy_types.index("Vehicle"))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_advanced_list_operations">Step 4: Advanced List Operations</h3>
<div class="sect3">
<h4 id="_list_comprehensions_2">List Comprehensions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Calculate premiums with a list comprehension
base_premiums = [1000, 1200, 1500, 2000]
risk_factors = [1.1, 1.2, 1.5, 1.8]

final_premiums = [base * risk for base, risk in zip(base_premiums, risk_factors)]
print("Final Premiums:", final_premiums)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nested_lists">Nested Lists</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Claims grouped by risk levels
claims_by_risk = [
    [1500, 2500],  # Low risk
    [3500, 4500],  # Medium risk
    [5500, 6500]   # High risk
]

# Accessing nested elements
print("High Risk Claims:", claims_by_risk[2])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_advanced_tuple_operations">Step 5: Advanced Tuple Operations</h3>
<div class="sect3">
<h4 id="_nested_tuples">Nested Tuples</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Policy details stored in tuples
policy_details = (
    ("POL12345", "John Doe", 1500),
    ("POL12346", "Jane Smith", 2500),
    ("POL12347", "Jim Brown", 3500)
)

# Accessing nested elements
print("First Policy Details:", policy_details[0])
print("Policy Holder of Second Policy:", policy_details[1][1])</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tuple_unpacking">Tuple Unpacking</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Unpacking policy details
policy_id, policy_holder, claim_amount = policy_details[0]
print(f"Policy ID: {policy_id}, Holder: {policy_holder}, Claim: ${claim_amount}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_combining_lists_and_tuples">Step 6: Combining Lists and Tuples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Combining lists and tuples for policy management
policies = [
    ("POL12345", "John Doe", "Life"),
    ("POL12346", "Jane Smith", "Health"),
    ("POL12347", "Jim Brown", "Vehicle")
]

# Adding a new policy
policies.append(("POL12348", "Jake White", "Property"))

# Filtering policies based on type
life_policies = [policy for policy in policies if policy[2] == "Life"]
print("Life Policies:", life_policies)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_real_world_example_claim_processing_pipeline_2">Step 7: Real-World Example: Claim Processing Pipeline</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Process claims data with lists and tuples
claims_data = [
    ("POL12345", 1500, "Low"),
    ("POL12346", 2500, "Medium"),
    ("POL12347", 3500, "High"),
    ("POL12348", 4500, "High")
]

# Filter high-risk claims
high_risk_claims = [claim for claim in claims_data if claim[2] == "High"]

# Calculate total high-risk claims
total_high_risk = sum(claim[1] for claim in high_risk_claims)

print("High Risk Claims:", high_risk_claims)
print("Total High Risk Claims:", total_high_risk)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_summary_3">Step 8: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Lists and tuples are versatile data structures for managing collections of data.</p>
</li>
<li>
<p>Lists are mutable and suitable for dynamic collections, while tuples are immutable and ideal for fixed data.</p>
</li>
<li>
<p>Combining lists and tuples enables efficient management of complex data in real-world scenarios, such as insurance policies and claims.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_mastering_dictionaries_and_sets_in_python">Lab: Mastering Dictionaries and Sets in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_10">Objective</h3>
<div class="paragraph">
<p>Provide a comprehensive exploration of Python dictionaries and sets by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Understanding their definitions and differences.</p>
</li>
<li>
<p>Demonstrating core functionalities with examples.</p>
</li>
<li>
<p>Applying advanced operations.</p>
</li>
<li>
<p>Using real-world scenarios in the insurance domain.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_data_management_2">Scenario: Insurance Policy and Claims Data Management</h3>
<div class="paragraph">
<p>Efficiently manage and analyze insurance policy and claims data using dictionaries and sets.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_dictionaries_and_sets">Step 1: Introduction to Dictionaries and Sets</h3>
<div class="sect3">
<h4 id="_dictionary_basics">Dictionary Basics</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Dictionary of policy details
policy_details = {
    "POL12345": {"holder": "John Doe", "premium": 1500},
    "POL12346": {"holder": "Jane Smith", "premium": 2500},
    "POL12347": {"holder": "Jim Brown", "premium": 3500}
}

# Accessing policy details
print("Policy Holder for POL12345:", policy_details["POL12345"]["holder"])

# Adding a new policy
policy_details["POL12348"] = {"holder": "Jake White", "premium": 4500}

# Removing a policy
del policy_details["POL12345"]

print("Updated Policy Details:", policy_details)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_set_basics">Set Basics</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Set of active policies
active_policies = {"POL12345", "POL12346", "POL12347"}

# Adding a new policy to the set
active_policies.add("POL12348")

# Removing a policy from the set
active_policies.discard("POL12345")

# Checking membership
print("Is POL12346 active?:", "POL12346" in active_policies)

print("Active Policies:", active_policies)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_key_differences_2">Key Differences</h4>
<div class="ulist">
<ul>
<li>
<p>Dictionaries store data as key-value pairs.</p>
</li>
<li>
<p>Sets store unique, unordered elements and are ideal for membership tests and unique collections.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_common_operations_on_dictionaries">Step 2: Common Operations on Dictionaries</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Managing claims using a dictionary
claims = {
    "POL12345": 1500,
    "POL12346": 2500,
    "POL12347": 3500
}

# Updating claim amounts
claims["POL12345"] += 500  # Adding an adjustment

# Iterating over dictionary items
for policy, amount in claims.items():
    print(f"Policy {policy} has a claim of ${amount}")

# Getting a value with a default
print("Claim for POL12348:", claims.get("POL12348", "No claim found"))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_common_operations_on_sets">Step 3: Common Operations on Sets</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Operations with active and expired policies
expired_policies = {"POL12345", "POL12349"}

# Union of active and expired policies
all_policies = active_policies.union(expired_policies)
print("All Policies:", all_policies)

# Intersection of active and expired policies
common_policies = active_policies.intersection(expired_policies)
print("Common Policies:", common_policies)

# Difference between active and expired policies
only_active = active_policies.difference(expired_policies)
print("Only Active Policies:", only_active)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_advanced_dictionary_operations">Step 4: Advanced Dictionary Operations</h3>
<div class="sect3">
<h4 id="_dictionary_comprehensions_2">Dictionary Comprehensions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Creating a dictionary of premiums above a threshold
premiums = {"POL12345": 1500, "POL12346": 2500, "POL12347": 3500}
high_premiums = {policy: amount for policy, amount in premiums.items() if amount &gt; 2000}
print("High Premiums:", high_premiums)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nested_dictionaries">Nested Dictionaries</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Nested dictionary for detailed claims data
claims_data = {
    "POL12345": {"amount": 1500, "status": "Pending"},
    "POL12346": {"amount": 2500, "status": "Approved"},
    "POL12347": {"amount": 3500, "status": "Denied"}
}

# Accessing nested data
print("Claim Amount for POL12346:", claims_data["POL12346"]["amount"])

# Updating claim status
claims_data["POL12345"]["status"] = "Approved"
print("Updated Claims Data:", claims_data)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_advanced_set_operations">Step 5: Advanced Set Operations</h3>
<div class="sect3">
<h4 id="_set_comprehensions">Set Comprehensions</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Creating a set of high-risk policies
high_risk_claims = {"POL12345", "POL12347", "POL12348"}
high_risk_set = {policy for policy in high_risk_claims if "7" in policy}
print("High Risk Policies:", high_risk_set)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_frozen_sets">Frozen Sets</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Using frozen sets for immutable collections
frozen_active_policies = frozenset(active_policies)
print("Frozen Active Policies:", frozen_active_policies)

# Attempting to modify (this will raise an error)
try:
    frozen_active_policies.add("POL12349")
except AttributeError as e:
    print("Error:", e)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_combining_dictionaries_and_sets">Step 6: Combining Dictionaries and Sets</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Managing policies with dictionaries and sets
policy_details = {
    "POL12345": {"holder": "John Doe", "premium": 1500},
    "POL12346": {"holder": "Jane Smith", "premium": 2500},
    "POL12347": {"holder": "Jim Brown", "premium": 3500}
}

active_policies = {"POL12345", "POL12346"}

# Finding active policy details
active_policy_details = {policy: policy_details[policy] for policy in active_policies}
print("Active Policy Details:", active_policy_details)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_real_world_example_policy_processing_pipeline">Step 7: Real-World Example: Policy Processing Pipeline</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Policy processing pipeline using dictionaries and sets
policies = {
    "POL12345": {"holder": "John Doe", "premium": 1500, "status": "Active"},
    "POL12346": {"holder": "Jane Smith", "premium": 2500, "status": "Expired"},
    "POL12347": {"holder": "Jim Brown", "premium": 3500, "status": "Active"}
}

# Extract active policies
active_policies = {policy for policy, details in policies.items() if details["status"] == "Active"}

# Calculate total premiums for active policies
total_premium = sum(policies[policy]["premium"] for policy in active_policies)

print("Active Policies:", active_policies)
print("Total Premium for Active Policies:", total_premium)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_summary_4">Step 8: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Dictionaries and sets are powerful tools for managing structured and unstructured data.</p>
</li>
<li>
<p>Dictionaries store key-value pairs and allow complex data modeling with nested structures.</p>
</li>
<li>
<p>Sets are ideal for unique collections, membership testing, and mathematical operations.</p>
</li>
<li>
<p>Combining dictionaries and sets enables efficient, real-world data management, such as insurance policy and claim processing.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_case_study_comprehensive_insurance_data_management_system">Case Study: Comprehensive Insurance Data Management System</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_11">Objective</h3>
<div class="paragraph">
<p>Develop a Python-based insurance data management system utilizing:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Lists, dictionaries, sets, and tuples for data storage and manipulation.</p>
</li>
<li>
<p>Functions for modular and reusable code.</p>
</li>
<li>
<p>Lambda functions for concise data processing.</p>
</li>
<li>
<p>Exception handling for robustness and error management.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_policy_and_claims_management">Scenario: Insurance Policy and Claims Management</h3>
<div class="paragraph">
<p>Create a system to manage policy details, validate claims, and calculate premiums while ensuring data integrity and error handling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_data_storage_with_lists_dictionaries_sets_and_tuples">Step 1: Data Storage with Lists, Dictionaries, Sets, and Tuples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># List of policy types
policy_types = ["Life", "Health", "Vehicle", "Property"]

# Dictionary of policy details
policy_details = {
    "POL12345": {"holder": "John Doe", "type": "Life", "premium": 1500},
    "POL12346": {"holder": "Jane Smith", "type": "Health", "premium": 2500},
    "POL12347": {"holder": "Jim Brown", "type": "Vehicle", "premium": 3500}
}

# Set of active policies
active_policies = {"POL12345", "POL12346"}

# Tuple of risk categories
risk_categories = ("Low", "Medium", "High")

print("Policy Types:", policy_types)
print("Policy Details:", policy_details)
print("Active Policies:", active_policies)
print("Risk Categories:", risk_categories)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_functions_for_policy_management">Step 2: Functions for Policy Management</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Function to calculate premium with risk factor

def calculate_premium(base_premium, risk_factor):
    """
    Calculate the premium based on risk factor.
    Arguments:
        base_premium (float): Base premium amount.
        risk_factor (float): Risk multiplier.
    Returns:
        float: Adjusted premium.
    """
    return base_premium * risk_factor

# Function to validate policy

def validate_policy(policy_id, policy_dict):
    """
    Validate if a policy exists in the system.
    Arguments:
        policy_id (str): Policy ID to validate.
        policy_dict (dict): Dictionary of policy details.
    Returns:
        bool: True if valid, False otherwise.
    """
    return policy_id in policy_dict

print("Premium for High Risk:", calculate_premium(2000, 1.5))
print("Is POL12345 a valid policy?:", validate_policy("POL12345", policy_details))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_lambda_functions_for_quick_processing">Step 3: Lambda Functions for Quick Processing</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Lambda function to check high premium
is_high_premium = lambda premium: premium &gt; 3000

# Apply lambda to filter high premium policies
high_premium_policies = {policy for policy, details in policy_details.items() if is_high_premium(details["premium"])}

print("High Premium Policies:", high_premium_policies)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_exception_handling_for_robustness">Step 4: Exception Handling for Robustness</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Function to safely fetch policy details

def get_policy_details(policy_id, policy_dict):
    """
    Fetch policy details safely with exception handling.
    Arguments:
        policy_id (str): Policy ID to fetch.
        policy_dict (dict): Dictionary of policy details.
    Returns:
        dict: Policy details if found.
    """
    try:
        return policy_dict[policy_id]
    except KeyError:
        print(f"Error: Policy {policy_id} not found.")
        return None

print("Details for POL12345:", get_policy_details("POL12345", policy_details))
print("Details for POL99999:", get_policy_details("POL99999", policy_details))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_combining_all_concepts_in_a_real_world_scenario">Step 5: Combining All Concepts in a Real-World Scenario</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Function to process claims

def process_claim(policy_id, claim_amount, policy_dict, active_set):
    """
    Process a claim for a given policy.
    Arguments:
        policy_id (str): Policy ID.
        claim_amount (float): Claim amount.
        policy_dict (dict): Dictionary of policy details.
        active_set (set): Set of active policies.
    Returns:
        str: Result of the claim processing.
    """
    try:
        if policy_id not in active_set:
            raise ValueError(f"Policy {policy_id} is not active.")

        if claim_amount &gt; policy_dict[policy_id]["premium"] * 2:
            return f"Claim for {policy_id} denied: Exceeds allowable limit."

        return f"Claim for {policy_id} approved: ${claim_amount} processed."

    except KeyError:
        return f"Error: Policy {policy_id} not found."
    except ValueError as e:
        return str(e)

# Test the function
print(process_claim("POL12345", 2000, policy_details, active_policies))
print(process_claim("POL12345", 4000, policy_details, active_policies))
print(process_claim("POL12348", 2000, policy_details, active_policies))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_summary_2">Step 6: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>This case study demonstrates the combined use of lists, dictionaries, sets, and tuples to manage structured data.</p>
</li>
<li>
<p>Functions ensure reusability and modularity in the code.</p>
</li>
<li>
<p>Lambda functions provide concise processing, while exception handling ensures robust error management.</p>
</li>
<li>
<p>The real-world insurance domain example highlights practical applications of Python concepts.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_mastering_file_operations_in_python">Lab: Mastering File Operations in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_12">Objective</h3>
<div class="paragraph">
<p>Provide a comprehensive guide to Python file operations by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Understanding file modes and their usage.</p>
</li>
<li>
<p>Demonstrating operations with CSV, JSON, and text files.</p>
</li>
<li>
<p>Using real-world scenarios for practical learning.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_file_modes">Step 1: Introduction to File Modes</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># File modes in Python:
file_modes = {
    "r": "Read - Opens a file for reading (default).",
    "w": "Write - Opens a file for writing (creates/truncates).",
    "x": "Exclusive creation - Fails if the file exists.",
    "a": "Append - Opens a file for appending.",
    "b": "Binary - Opens a file in binary mode.",
    "t": "Text - Opens a file in text mode (default).",
    "+": "Read and write mode."
}

for mode, description in file_modes.items():
    print(f"Mode '{mode}': {description}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_basic_text_file_operations">Step 2: Basic Text File Operations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Writing to a text file
with open("policies.txt", "w") as file:
    file.write("POL12345, John Doe, Life, 1500\n")
    file.write("POL12346, Jane Smith, Health, 2500\n")

# Reading from a text file
with open("policies.txt", "r") as file:
    content = file.readlines()
    print("File Content:", content)

# Appending to a text file
with open("policies.txt", "a") as file:
    file.write("POL12347, Jim Brown, Vehicle, 3500\n")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_working_with_csv_files">Step 3: Working with CSV Files</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import csv

# Writing to a CSV file
with open("policies.csv", "w", newline="") as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(["PolicyID", "Holder", "Type", "Premium"])
    writer.writerow(["POL12345", "John Doe", "Life", 1500])
    writer.writerow(["POL12346", "Jane Smith", "Health", 2500])

# Reading from a CSV file
with open("policies.csv", "r") as csvfile:
    reader = csv.reader(csvfile)
    for row in reader:
        print(row)

# Writing to a CSV file with DictWriter
with open("policies_dict.csv", "w", newline="") as csvfile:
    fieldnames = ["PolicyID", "Holder", "Type", "Premium"]
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    writer.writerow({"PolicyID": "POL12345", "Holder": "John Doe", "Type": "Life", "Premium": 1500})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_working_with_json_files">Step 4: Working with JSON Files</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import json

# Writing to a JSON file
policy_data = {
    "POL12345": {"holder": "John Doe", "type": "Life", "premium": 1500},
    "POL12346": {"holder": "Jane Smith", "type": "Health", "premium": 2500}
}

with open("policies.json", "w") as jsonfile:
    json.dump(policy_data, jsonfile, indent=4)

# Reading from a JSON file
with open("policies.json", "r") as jsonfile:
    data = json.load(jsonfile)
    print("Policy Data:", data)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_handling_binary_files">Step 5: Handling Binary Files</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Writing to a binary file
with open("policy_binary.bin", "wb") as binfile:
    binfile.write(b"Policy Data: POL12345, John Doe, Life, 1500")

# Reading from a binary file
with open("policy_binary.bin", "rb") as binfile:
    binary_content = binfile.read()
    print("Binary Content:", binary_content)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_combining_file_operations_in_a_real_world_scenario">Step 6: Combining File Operations in a Real-World Scenario</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import csv
import json

# Step 1: Read policies from a CSV file
with open("policies.csv", "r") as csvfile:
    reader = csv.DictReader(csvfile)
    policies = [row for row in reader]

# Step 2: Filter policies with premiums above a threshold
high_premium_policies = [policy for policy in policies if int(policy["Premium"]) &gt; 2000]

# Step 3: Save filtered policies to a JSON file
with open("high_premium_policies.json", "w") as jsonfile:
    json.dump(high_premium_policies, jsonfile, indent=4)

# Step 4: Append a summary to a text file
with open("policy_summary.txt", "a") as file:
    file.write(f"Total High Premium Policies: {len(high_premium_policies)}\n")
    file.write("High Premium Policies saved to high_premium_policies.json\n")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>File modes provide flexibility in handling different file operations.</p>
</li>
<li>
<p>Python’s libraries for CSV and JSON make it easy to work with structured data.</p>
</li>
<li>
<p>Combining these operations enables powerful data processing pipelines for real-world scenarios, such as insurance policy management.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_functional_programming_in_python">Lab: Functional Programming in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_13">Objective</h3>
<div class="paragraph">
<p>Provide a detailed guide to functional programming in Python, focusing on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Features of functional programming.</p>
</li>
<li>
<p>Pure functions and immutability.</p>
</li>
<li>
<p>Higher-order functions and using functions as arguments/return values.</p>
</li>
<li>
<p>Scope of variables in functional programming.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_functional_programming">Step 1: Introduction to Functional Programming</h3>
<div class="paragraph">
<p>Functional programming is a programming paradigm where functions are treated as first-class citizens and computation is performed using mathematical functions. Key principles include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Immutability</strong>: Data is not modified after creation.</p>
</li>
<li>
<p><strong>Pure Functions</strong>: Functions produce the same output for the same input without side effects.</p>
</li>
<li>
<p><strong>First-Class Functions</strong>: Functions can be passed as arguments, returned as values, and stored in variables.</p>
</li>
<li>
<p><strong>Higher-Order Functions</strong>: Functions that take other functions as arguments or return them as results.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_pure_functions">Step 2: Pure Functions</h3>
<div class="sect3">
<h4 id="_what_is_a_pure_function">What is a Pure Function?</h4>
<div class="ulist">
<ul>
<li>
<p>A function is considered pure if:</p>
</li>
<li>
<p>It has no side effects.</p>
</li>
<li>
<p>The output depends solely on the input.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Pure Function

def add_numbers(a, b):
    """Adds two numbers without modifying external state."""
    return a + b

print(add_numbers(2, 3))  # Always produces 5

# Example: Impure Function
result = 0

def add_to_result(value):
    """Adds value to a global variable (impure)."""
    global result
    result += value
    return result

print(add_to_result(5))  # Depends on external state</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_key_benefits_of_pure_functions">Key Benefits of Pure Functions</h4>
<div class="ulist">
<ul>
<li>
<p>Easier to test and debug.</p>
</li>
<li>
<p>More predictable behavior.</p>
</li>
<li>
<p>Suitable for parallel processing.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_immutability">Step 3: Immutability</h3>
<div class="sect3">
<h4 id="_mutable_vs_immutable_data_types">Mutable vs Immutable Data Types</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Immutable</strong>: Data cannot be changed (e.g., <code>int</code>, <code>tuple</code>, <code>str</code>).</p>
</li>
<li>
<p><strong>Mutable</strong>: Data can be changed (e.g., <code>list</code>, <code>dict</code>).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Immutable Data
x = (1, 2, 3)
try:
    x[0] = 10
except TypeError as e:
    print("Error:", e)

# Example: Mutable Data
y = [1, 2, 3]
y[0] = 10
print(y)  # [10, 2, 3]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_immutability_in_functional_programming">Immutability in Functional Programming</h4>
<div class="ulist">
<ul>
<li>
<p>Avoid mutating data to ensure predictable results.</p>
</li>
<li>
<p>Use immutable types like <code>tuple</code> or functional libraries like <code>frozenset</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_higher_order_functions">Step 4: Higher-Order Functions</h3>
<div class="sect3">
<h4 id="_what_is_a_higher_order_function">What is a Higher-Order Function?</h4>
<div class="ulist">
<ul>
<li>
<p>A function that:</p>
</li>
<li>
<p>Takes another function as an argument.</p>
</li>
<li>
<p>Returns a function as a result.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_using_functions_as_arguments">Using Functions as Arguments</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Using a Function as an Argument

def apply_function(func, value):
    """Applies a function to a value."""
    return func(value)

# Function to double a number
def double(x):
    return x * 2

print(apply_function(double, 5))  # Output: 10</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_returning_a_function">Returning a Function</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Returning a Function

def multiplier(factor):
    """Returns a function that multiplies by the given factor."""
    def multiply(value):
        return value * factor
    return multiply

# Create a function that triples a value
triple = multiplier(3)
print(triple(5))  # Output: 15</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_scope_of_variables">Step 5: Scope of Variables</h3>
<div class="sect3">
<h4 id="_variable_scope_in_python">Variable Scope in Python</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Local Scope</strong>: Variables defined inside a function.</p>
</li>
<li>
<p><strong>Global Scope</strong>: Variables defined outside any function.</p>
</li>
<li>
<p><strong>Nonlocal Scope</strong>: Variables in an enclosing function for nested functions.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Local, Global, and Nonlocal Scope
x = 10  # Global variable

def outer_function():
    y = 20  # Enclosing variable

    def inner_function():
        nonlocal y
        y += 5
        print("Inner y:", y)

    inner_function()
    print("Outer y:", y)

outer_function()
print("Global x:", x)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_real_world_insurance_premium_calculator">Step 6: Real-World : Insurance Premium Calculator</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Step 1: Pure Function to Calculate Premium
def calculate_premium(base, risk_factor):
    return base * risk_factor

# Step 2: Higher-Order Function to Apply Discounts
def apply_discount(discount_func, premium):
    return discount_func(premium)

# Discount Function
def ten_percent_discount(premium):
    return premium * 0.9

# Step 3: Returning a Function for Tax Calculation
def tax_calculator(tax_rate):
    def calculate_tax(amount):
        return amount * tax_rate
    return calculate_tax

# Step 4: Combining All Concepts
premium = calculate_premium(1000, 1.2)
premium_after_discount = apply_discount(ten_percent_discount, premium)
calculate_tax = tax_calculator(0.05)
total_with_tax = premium_after_discount + calculate_tax(premium_after_discount)

print(f"Base Premium: {premium}")
print(f"Premium After Discount: {premium_after_discount}")
print(f"Total with Tax: {total_with_tax}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary_2">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Functional programming promotes immutability and pure functions for predictable results.</p>
</li>
<li>
<p>Higher-order functions allow flexible and reusable code by operating on other functions.</p>
</li>
<li>
<p>Understanding variable scope is crucial for avoiding unintended side effects.</p>
</li>
<li>
<p>Applying these principles can simplify complex real-world problems, as shown in the case study.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_functional_programming_in_python_case_driven">Lab: Functional Programming in Python (Case-Driven)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_14">Objective</h3>
<div class="paragraph">
<p>Explore functional programming in Python through a case-driven approach, focusing on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Principles of functional programming.</p>
</li>
<li>
<p>Application of pure functions and immutability.</p>
</li>
<li>
<p>Usage of higher-order functions and function composition.</p>
</li>
<li>
<p>Managing variable scope in real-world scenarios.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_claim_processing_system">Scenario: Insurance Claim Processing System</h3>
<div class="paragraph">
<p>You are tasked with creating a Python-based system for an insurance company. The system must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Calculate premiums for various policies.</p>
</li>
<li>
<p>Apply discounts based on policy type.</p>
</li>
<li>
<p>Add taxes to the final premium amount.</p>
</li>
<li>
<p>Ensure all calculations are performed using functional programming principles.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_setting_up_data_and_problem_statement">Step 1: Setting Up Data and Problem Statement</h3>
<div class="paragraph">
<p>Define the initial data and objective.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Initial data: List of policies with base premiums and policy types
policies = [
    {"policy_id": "POL12345", "base_premium": 1000, "policy_type": "Life"},
    {"policy_id": "POL12346", "base_premium": 1500, "policy_type": "Health"},
    {"policy_id": "POL12347", "base_premium": 2000, "policy_type": "Vehicle"}
]

# Objective: Calculate the final premium for each policy after discounts and taxes.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_pure_function_for_premium_calculation">Step 2: Pure Function for Premium Calculation</h3>
<div class="sect3">
<h4 id="_create_a_pure_function_to_calculate_premiums_based_on_a_risk_factor">Create a pure function to calculate premiums based on a risk factor.</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Pure function for premium calculation
def calculate_premium(base_premium, risk_factor):
    """Calculate the premium based on base amount and risk factor."""
    return base_premium * risk_factor

# Test the function
print(calculate_premium(1000, 1.2))  # Output: 1200</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_applying_discounts_using_higher_order_functions">Step 3: Applying Discounts Using Higher-Order Functions</h3>
<div class="sect3">
<h4 id="_define_a_higher_order_function_to_apply_discounts_based_on_policy_type">Define a higher-order function to apply discounts based on policy type.</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Discount functions for different policy types
def life_discount(premium):
    return premium * 0.95

def health_discount(premium):
    return premium * 0.90

def vehicle_discount(premium):
    return premium * 0.85

# Higher-order function to apply discount based on policy type
def apply_discount(policy, discount_func):
    """Apply a discount to the premium based on policy type."""
    premium = policy["base_premium"]
    return discount_func(premium)

# Test with a policy
policy = {"policy_id": "POL12345", "base_premium": 1000, "policy_type": "Life"}
print(apply_discount(policy, life_discount))  # Output: 950</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_returning_a_function_for_tax_calculation">Step 4: Returning a Function for Tax Calculation</h3>
<div class="sect3">
<h4 id="_create_a_function_that_returns_another_function_to_calculate_taxes">Create a function that returns another function to calculate taxes.</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Function returning a tax calculator
def tax_calculator(tax_rate):
    """Return a function to calculate tax on a given amount."""
    def calculate_tax(amount):
        return amount * tax_rate
    return calculate_tax

# Test the tax calculator
calculate_tax = tax_calculator(0.05)  # 5% tax
print(calculate_tax(1000))  # Output: 50</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_combining_all_steps">Step 5: Combining All Steps</h3>
<div class="sect3">
<h4 id="_build_the_final_pipeline_to_calculate_the_total_premium_for_all_policies">Build the final pipeline to calculate the total premium for all policies.</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Function to process a single policy
def process_policy(policy, discount_funcs, tax_func):
    """Process a policy to calculate the final premium."""
    policy_type = policy["policy_type"].lower()
    discount_func = discount_funcs.get(policy_type, lambda x: x)  # Default: no discount

    # Step 1: Calculate the premium
    base_premium = policy["base_premium"]
    premium = calculate_premium(base_premium, 1.2)  # Assume risk factor = 1.2

    # Step 2: Apply discount
    premium_after_discount = discount_func(premium)

    # Step 3: Add tax
    total_premium = premium_after_discount + tax_func(premium_after_discount)

    return {"policy_id": policy["policy_id"], "total_premium": total_premium}

# Mapping policy types to discount functions
discount_funcs = {
    "life": life_discount,
    "health": health_discount,
    "vehicle": vehicle_discount
}

# Tax function
tax_func = tax_calculator(0.05)

# Process all policies
processed_policies = [process_policy(policy, discount_funcs, tax_func) for policy in policies]

print("Processed Policies:", processed_policies)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_understanding_variable_scope">Step 6: Understanding Variable Scope</h3>
<div class="sect3">
<h4 id="_demonstrate_local_global_and_nonlocal_scopes">Demonstrate local, global, and nonlocal scopes.</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example of variable scopes
x = 10  # Global variable

def outer_function():
    y = 20  # Enclosing variable

    def inner_function():
        nonlocal y
        y += 5
        print("Inner y:", y)  # Access enclosing variable

    inner_function()
    print("Outer y:", y)  # Modified by inner_function

outer_function()
print("Global x:", x)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary_3">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>Functional programming enables clean, predictable, and reusable code.</p>
</li>
<li>
<p>Pure functions and immutability minimize side effects and make debugging easier.</p>
</li>
<li>
<p>Higher-order functions allow flexible operations like applying discounts and taxes dynamically.</p>
</li>
<li>
<p>Understanding variable scope helps manage data effectively in nested functions.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_run_and_verify">Step 8: Run and Verify</h3>
<div class="paragraph">
<p>To run the lab, save the code as <code>functional_programming_lab.py</code> and execute it using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">python functional_programming_lab.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the outputs match the expected results for each policy processed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_case_study_functional_programming_for_bcbs_operations">Case Study: Functional Programming for BCBS Operations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_15">Objective</h3>
<div class="paragraph">
<p>Implement a functional programming approach to streamline BCBS (Blue Cross Blue Shield) operations, focusing on:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Managing hospital and doctor collaboration data.</p>
</li>
<li>
<p>Sharing resources between BCBS companies.</p>
</li>
<li>
<p>Joint enrollment and billing functions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This case study uses Python&#8217;s functional programming principles to create reusable, composable, and predictable solutions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_defining_the_problem">Step 1: Defining the Problem</h3>
<div class="paragraph">
<p>BCBS companies operate in a decentralized model but collaborate in key areas:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Maintain a list of hospitals and doctors in a community.</p>
</li>
<li>
<p>Share office space and resources between companies.</p>
</li>
<li>
<p>Conduct joint enrollment and billing for members.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We will solve this using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pure functions for predictable operations.</p>
</li>
<li>
<p>Higher-order functions for reusable logic.</p>
</li>
<li>
<p>Data immutability to maintain consistent state.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_setting_up_initial_data">Step 2: Setting Up Initial Data</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># List of hospitals and doctors in the community
hospitals = [
    {"hospital_id": "H001", "name": "Community Hospital", "city": "Springfield"},
    {"hospital_id": "H002", "name": "Central Medical Center", "city": "Rivertown"}
]

doctors = [
    {"doctor_id": "D001", "name": "Dr. Smith", "specialty": "Cardiology", "hospital_id": "H001"},
    {"doctor_id": "D002", "name": "Dr. Johnson", "specialty": "Orthopedics", "hospital_id": "H002"}
]

# BCBS companies sharing resources
bcbs_companies = [
    {"company_id": "C001", "name": "BCBS Springfield", "shared_office": True},
    {"company_id": "C002", "name": "BCBS Rivertown", "shared_office": True}
]

# Enrollment data
members = [
    {"member_id": "M001", "name": "Alice", "plan": "Basic", "company_id": "C001"},
    {"member_id": "M002", "name": "Bob", "plan": "Premium", "company_id": "C002"}
]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_functional_operations_for_data_management">Step 3: Functional Operations for Data Management</h3>
<div class="sect3">
<h4 id="_pure_function_mapping_doctors_to_hospitals">Pure Function: Mapping Doctors to Hospitals</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def map_doctors_to_hospitals(doctors, hospitals):
    """Map doctors to their respective hospitals."""
    return [
        {
            **doctor,
            "hospital_name": next(
                (hospital["name"] for hospital in hospitals if hospital["hospital_id"] == doctor["hospital_id"]),
                "Unknown"
            )
        }
        for doctor in doctors
    ]

# Test the function
mapped_doctors = map_doctors_to_hospitals(doctors, hospitals)
print("Mapped Doctors:", mapped_doctors)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_higher_order_function_filter_shared_resources">Higher-Order Function: Filter Shared Resources</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def filter_shared_resources(companies, filter_func):
    """Filter companies based on a condition."""
    return list(filter(filter_func, companies))

# Test the function
shared_office_companies = filter_shared_resources(bcbs_companies, lambda c: c["shared_office"])
print("Companies Sharing Offices:", shared_office_companies)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_composing_enrollment_data">Composing Enrollment Data</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def enrich_member_data(members, companies):
    """Enrich members with company names."""
    return [
        {
            **member,
            "company_name": next(
                (company["name"] for company in companies if company["company_id"] == member["company_id"]),
                "Unknown"
            )
        }
        for member in members
    ]

# Test the function
enriched_members = enrich_member_data(members, bcbs_companies)
print("Enriched Members:", enriched_members)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_joint_enrollment_and_billing">Step 4: Joint Enrollment and Billing</h3>
<div class="sect3">
<h4 id="_function_composition_calculate_total_members_and_premium_revenue">Function Composition: Calculate Total Members and Premium Revenue</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def calculate_revenue_by_company(members, plans):
    """Calculate total revenue by company based on member plans."""
    return {
        company_id: sum(plans[member["plan"]] for member in members if member["company_id"] == company_id)
        for company_id in {member["company_id"] for member in members}
    }

# Define plan rates
plan_rates = {"Basic": 100, "Premium": 200}

# Test the function
revenue_by_company = calculate_revenue_by_company(members, plan_rates)
print("Revenue by Company:", revenue_by_company)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_sharing_office_space_and_resources">Step 5: Sharing Office Space and Resources</h3>
<div class="sect3">
<h4 id="_aggregating_shared_resource_usage">Aggregating Shared Resource Usage</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def aggregate_shared_resources(companies):
    """Aggregate shared resources among BCBS companies."""
    return len([company for company in companies if company["shared_office"]])

# Test the function
shared_resource_count = aggregate_shared_resources(bcbs_companies)
print("Total Companies Sharing Resources:", shared_resource_count)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_end_to_end_pipeline">Step 6: End-to-End Pipeline</h3>
<div class="sect3">
<h4 id="_process_all_data_together">Process All Data Together</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def process_bcbs_data(doctors, hospitals, members, companies):
    """Process BCBS data to produce final insights."""
    # Step 1: Map doctors to hospitals
    mapped_doctors = map_doctors_to_hospitals(doctors, hospitals)

    # Step 2: Enrich members with company data
    enriched_members = enrich_member_data(members, companies)

    # Step 3: Calculate revenue by company
    plan_rates = {"Basic": 100, "Premium": 200}
    revenue = calculate_revenue_by_company(members, plan_rates)

    return {
        "mapped_doctors": mapped_doctors,
        "enriched_members": enriched_members,
        "revenue": revenue
    }

# Run the pipeline
final_data = process_bcbs_data(doctors, hospitals, members, bcbs_companies)
print("Final Data:", final_data)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary_4">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Pure Functions</strong>: Ensure predictable operations like mapping doctors to hospitals.</p>
</li>
<li>
<p><strong>Higher-Order Functions</strong>: Reuse logic for filtering and enrichment.</p>
</li>
<li>
<p><strong>Data Composition</strong>: Build enriched and aggregated insights like member data and revenue.</p>
</li>
<li>
<p><strong>Real-World Applicability</strong>: Demonstrated a complete pipeline for BCBS operations using functional programming principles.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_object_oriented_programming_in_python">Lab: Object-Oriented Programming in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_16">Objective</h3>
<div class="paragraph">
<p>Provide a comprehensive guide to Object-Oriented Programming (OOP) in Python by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introducing OOP concepts and principles.</p>
</li>
<li>
<p>Explaining key features: encapsulation, inheritance, polymorphism, and abstraction.</p>
</li>
<li>
<p>Demonstrating these concepts with detailed examples and a real-world case study.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_oop">Step 1: Introduction to OOP</h3>
<div class="paragraph">
<p>Object-Oriented Programming (OOP) is a programming paradigm based on the concept of "objects," which can contain data (attributes) and code (methods).</p>
</div>
<div class="sect3">
<h4 id="_key_features_of_oop">Key Features of OOP</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Encapsulation</strong>: Bundling data and methods that operate on the data within a single unit (class).</p>
</li>
<li>
<p><strong>Inheritance</strong>: Enabling a new class (child) to inherit attributes and methods from an existing class (parent).</p>
</li>
<li>
<p><strong>Polymorphism</strong>: Allowing objects of different classes to be treated as objects of a common superclass.</p>
</li>
<li>
<p><strong>Abstraction</strong>: Hiding implementation details and exposing only the necessary functionality.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_encapsulation">Step 2: Encapsulation</h3>
<div class="sect3">
<h4 id="_what_is_encapsulation">What is Encapsulation?</h4>
<div class="paragraph">
<p>Encapsulation ensures that the internal representation of an object is hidden from the outside world, and access is controlled through methods (getters and setters).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Encapsulation
class InsurancePolicy:
    def __init__(self, policy_id, policy_holder, premium):
        self.__policy_id = policy_id  # Private attribute
        self.policy_holder = policy_holder
        self.__premium = premium  # Private attribute

    # Getter for premium
    def get_premium(self):
        return self.__premium

    # Setter for premium
    def set_premium(self, new_premium):
        if new_premium &gt; 0:
            self.__premium = new_premium
        else:
            print("Invalid premium value.")

# Test Encapsulation
policy = InsurancePolicy("POL12345", "John Doe", 1500)
print("Premium:", policy.get_premium())
policy.set_premium(2000)
print("Updated Premium:", policy.get_premium())
policy.set_premium(-500)  # Invalid value</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_inheritance">Step 3: Inheritance</h3>
<div class="sect3">
<h4 id="_what_is_inheritance">What is Inheritance?</h4>
<div class="paragraph">
<p>Inheritance allows a class to acquire the properties and methods of another class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Inheritance
class Policy:
    def __init__(self, policy_id, policy_holder):
        self.policy_id = policy_id
        self.policy_holder = policy_holder

    def display_details(self):
        print(f"Policy ID: {self.policy_id}, Holder: {self.policy_holder}")

# Derived class
class HealthPolicy(Policy):
    def __init__(self, policy_id, policy_holder, coverage_amount):
        super().__init__(policy_id, policy_holder)  # Call parent constructor
        self.coverage_amount = coverage_amount

    def display_details(self):
        super().display_details()  # Call parent method
        print(f"Coverage Amount: {self.coverage_amount}")

# Test Inheritance
health_policy = HealthPolicy("HP12345", "Jane Smith", 500000)
health_policy.display_details()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_polymorphism">Step 4: Polymorphism</h3>
<div class="sect3">
<h4 id="_what_is_polymorphism">What is Polymorphism?</h4>
<div class="paragraph">
<p>Polymorphism allows methods in different classes to have the same name but behave differently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Polymorphism
class VehiclePolicy:
    def display_details(self):
        print("Vehicle Policy Details")

class LifePolicy:
    def display_details(self):
        print("Life Policy Details")

# Polymorphic behavior
def show_policy_details(policy):
    policy.display_details()

# Test Polymorphism
vehicle_policy = VehiclePolicy()
life_policy = LifePolicy()
show_policy_details(vehicle_policy)  # Vehicle Policy Details
show_policy_details(life_policy)    # Life Policy Details</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_abstraction">Step 5: Abstraction</h3>
<div class="sect3">
<h4 id="_what_is_abstraction">What is Abstraction?</h4>
<div class="paragraph">
<p>Abstraction hides the implementation details and provides only essential information to the user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from abc import ABC, abstractmethod

# Abstract Base Class
class AbstractPolicy(ABC):
    @abstractmethod
    def calculate_premium(self):
        pass

# Concrete class
class TermPolicy(AbstractPolicy):
    def __init__(self, policy_id, term_years, base_premium):
        self.policy_id = policy_id
        self.term_years = term_years
        self.base_premium = base_premium

    def calculate_premium(self):
        return self.base_premium * self.term_years

# Test Abstraction
term_policy = TermPolicy("TP12345", 10, 1000)
print("Total Premium:", term_policy.calculate_premium())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_real_world_scenario_insurance_management_system">Step 6: Real-World scenario: Insurance Management System</h3>
<div class="sect3">
<h4 id="_scenario">Scenario</h4>
<div class="paragraph">
<p>Build an insurance management system with the following features:
1. Different policy types (Health, Vehicle, Life).
2. Common attributes (policy ID, policy holder).
3. Specific behavior for each policy type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">class Policy:
    def __init__(self, policy_id, policy_holder):
        self.policy_id = policy_id
        self.policy_holder = policy_holder

    def calculate_premium(self):
        pass

class HealthPolicy(Policy):
    def __init__(self, policy_id, policy_holder, coverage_amount):
        super().__init__(policy_id, policy_holder)
        self.coverage_amount = coverage_amount

    def calculate_premium(self):
        return self.coverage_amount * 0.02

class VehiclePolicy(Policy):
    def __init__(self, policy_id, policy_holder, vehicle_value):
        super().__init__(policy_id, policy_holder)
        self.vehicle_value = vehicle_value

    def calculate_premium(self):
        return self.vehicle_value * 0.03

class LifePolicy(Policy):
    def __init__(self, policy_id, policy_holder, sum_assured):
        super().__init__(policy_id, policy_holder)
        self.sum_assured = sum_assured

    def calculate_premium(self):
        return self.sum_assured * 0.01

# Test Case Study
policies = [
    HealthPolicy("HP001", "Alice", 500000),
    VehiclePolicy("VP001", "Bob", 300000),
    LifePolicy("LP001", "Charlie", 1000000)
]

for policy in policies:
    print(f"Policy ID: {policy.policy_id}, Premium: {policy.calculate_premium()}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary_5">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Encapsulation</strong>: Protect sensitive data using private attributes and controlled access.</p>
</li>
<li>
<p><strong>Inheritance</strong>: Reuse code by deriving new classes from existing ones.</p>
</li>
<li>
<p><strong>Polymorphism</strong>: Enable methods with the same name to work across different classes.</p>
</li>
<li>
<p><strong>Abstraction</strong>: Simplify complex systems by hiding implementation details.</p>
</li>
<li>
<p>The case study demonstrates how to use OOP principles in a real-world context.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_run_and_verify_2">Step 8: Run and Verify</h3>
<div class="paragraph">
<p>To run the lab, save the code as <code>oop_lab.py</code> and execute it using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">python oop_lab.py</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the outputs match the expected behavior for each policy type.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_comprehensive_testing_in_python">Lab: Comprehensive Testing in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_17">Objective</h3>
<div class="paragraph">
<p>Provide a step-by-step guide to testing in Python by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introducing testing fundamentals.</p>
</li>
<li>
<p>Exploring basic to advanced use cases.</p>
</li>
<li>
<p>Covering unit testing, integration testing, and edge cases.</p>
</li>
<li>
<p>Using real-world insurance domain scenarios.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_setting_up_the_environment">Step 1: Setting Up the Environment</h3>
<div class="sect3">
<h4 id="_install_dependencies">Install Dependencies</h4>
<div class="paragraph">
<p>To run this lab, ensure the following dependencies are installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">pip install pytest unittest2</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pytest</code>: A testing framework for Python.</p>
</li>
<li>
<p><code>unittest2</code>: Backport of Python&#8217;s built-in <code>unittest</code> module for older versions of Python.</p>
</li>
<li>
<p>Ensure you are using Python 3.6 or later.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_verify_the_setup">Verify the Setup</h4>
<div class="paragraph">
<p>Check if the dependencies are installed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">pytest --version
python -m unittest --help</code></pre>
</div>
</div>
<div class="paragraph">
<p>The commands should print the respective versions and usage information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_introduction_to_testing">Step 2: Introduction to Testing</h3>
<div class="sect3">
<h4 id="_what_is_testing">What is Testing?</h4>
<div class="ulist">
<ul>
<li>
<p>Testing ensures that your code behaves as expected.</p>
</li>
<li>
<p>Types of testing covered:</p>
</li>
<li>
<p><strong>Unit Testing:</strong> Testing individual functions or components.</p>
</li>
<li>
<p><strong>Integration Testing:</strong> Testing combined components or workflows.</p>
</li>
<li>
<p><strong>Edge Case Testing:</strong> Verifying behavior in unusual or extreme cases.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_python_testing_frameworks">Python Testing Frameworks</h4>
<div class="ulist">
<ul>
<li>
<p><strong><code>unittest</code>:</strong> Built-in Python library for testing.</p>
</li>
<li>
<p><strong><code>pytest</code>:</strong> Popular third-party library with advanced features.</p>
</li>
<li>
<p><strong><code>mock</code>:</strong> Used to simulate objects and behavior.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Importing the unittest framework
import unittest

# Example: Simple function to test
def add_numbers(a, b):
    return a + b

# Writing a basic test case
class TestAddNumbers(unittest.TestCase):
    def test_add_positive(self):
        self.assertEqual(add_numbers(2, 3), 5)

    def test_add_negative(self):
        self.assertEqual(add_numbers(-2, -3), -5)

if __name__ == "__main__":
    unittest.main()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_writing_unit_tests">Step 3: Writing Unit Tests</h3>
<div class="sect3">
<h4 id="_function_to_test">Function to Test</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function to calculate premium

def calculate_premium(base, risk_factor):
    if base &lt;= 0 or risk_factor &lt;= 0:
        raise ValueError("Base and risk factor must be positive.")
    return base * risk_factor</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_writing_unit_tests">Writing Unit Tests</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import unittest

class TestCalculatePremium(unittest.TestCase):

    def test_valid_premium(self):
        self.assertEqual(calculate_premium(1000, 1.2), 1200)

    def test_zero_base(self):
        with self.assertRaises(ValueError):
            calculate_premium(0, 1.2)

    def test_negative_risk_factor(self):
        with self.assertRaises(ValueError):
            calculate_premium(1000, -1.2)

if __name__ == "__main__":
    unittest.main()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_testing_with_pytest">Step 4: Testing with <code>pytest</code></h3>
<div class="sect3">
<h4 id="_function_to_test_2">Function to Test</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Example: Function to determine policy status

def policy_status(policies, policy_id):
    """
    Return the status of a policy.
    """
    return policies.get(policy_id, "Policy not found")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_writing_tests_with_pytest">Writing Tests with <code>pytest</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import pytest

# Example test cases
def test_valid_policy():
    policies = {"POL12345": "Active", "POL12346": "Expired"}
    assert policy_status(policies, "POL12345") == "Active"

def test_invalid_policy():
    policies = {"POL12345": "Active"}
    assert policy_status(policies, "POL99999") == "Policy not found"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_mocking_in_tests">Step 5: Mocking in Tests</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">from unittest.mock import patch

# Example: Simulating external function behavior
@patch("builtins.print")
def test_mocked_function(mock_print):
    print("Testing mock")
    mock_print.assert_called_with("Testing mock")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_integration_testing">Step 6: Integration Testing</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Integration testing multiple functions

def validate_policy(policy_id, active_policies):
    if policy_id not in active_policies:
        raise ValueError("Policy is not active.")
    return "Policy is valid"

def calculate_claim(policy_id, claim_amount, active_policies):
    try:
        validate_policy(policy_id, active_policies)
        return f"Claim approved for {claim_amount}"
    except ValueError as e:
        return str(e)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_writing_integration_tests">Writing Integration Tests</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def test_integration():
    active_policies = {"POL12345", "POL12346"}
    assert calculate_claim("POL12345", 1000, active_policies) == "Claim approved for 1000"
    assert calculate_claim("POL12347", 1000, active_policies) == "Policy is not active."</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_testing_edge_cases">Step 7: Testing Edge Cases</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def test_edge_cases():
    # Test with extreme values
    assert calculate_premium(1e6, 1.5) == 1.5e6
    assert policy_status({}, "POL12345") == "Policy not found"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_real_world_case_scenario_insurance_claims_system">Step 8: Real-World Case Scenario: Insurance Claims System</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># System to validate claims and calculate premium

def process_claim(policy_id, claim_amount, policies):
    """Process a claim for a policy."""
    if policy_id not in policies:
        return "Policy not found"

    if claim_amount &gt; policies[policy_id]["premium"] * 2:
        return "Claim denied: Exceeds limit"

    return "Claim approved"

# Writing tests for the claims system
def test_claim_system():
    policies = {
        "POL12345": {"premium": 1500},
        "POL12346": {"premium": 2500}
    }
    assert process_claim("POL12345", 3000, policies) == "Claim approved"
    assert process_claim("POL12345", 4000, policies) == "Claim denied: Exceeds limit"
    assert process_claim("POL99999", 2000, policies) == "Policy not found"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_9_run_and_verify">Step 9: Run and Verify</h3>
<div class="sect3">
<h4 id="_running_unittest">Running <code>unittest</code></h4>
<div class="ulist">
<ul>
<li>
<p>Save your test script as <code>test_script.py</code>.</p>
</li>
<li>
<p>Run the tests using the following command:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">python -m unittest test_script.py</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_running_pytest">Running <code>pytest</code></h4>
<div class="ulist">
<ul>
<li>
<p>Save your test script as <code>test_script.py</code>.</p>
</li>
<li>
<p>Run the tests using the following command:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">pytest test_script.py</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To run all test files in the directory:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">pytest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To generate a detailed output:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">pytest -v</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_10_summary">Step 10: Summary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Unit Testing:</strong> Focus on individual components like functions.</p>
</li>
<li>
<p><strong>Integration Testing:</strong> Validate interactions between components.</p>
</li>
<li>
<p><strong>Edge Case Testing:</strong> Ensure robustness with extreme inputs.</p>
</li>
<li>
<p>Tools like <code>unittest</code> and <code>pytest</code> simplify testing workflows, while mocking enables testing external dependencies effectively.</p>
</li>
<li>
<p>Follow the setup and execution steps to validate your scripts.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_database_basics_with_python">Lab: Database Basics with Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_18">Objective</h3>
<div class="paragraph">
<p>This lab introduces the basics of working with relational databases in Python. You will:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set up a SQLite database.</p>
</li>
<li>
<p>Perform CRUD (Create, Read, Update, Delete) operations.</p>
</li>
<li>
<p>Use SQL queries for data manipulation and retrieval.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_setting_up_sqlite">Step 1: Setting Up SQLite</h3>
<div class="sect3">
<h4 id="_what_is_sqlite">What is SQLite?</h4>
<div class="paragraph">
<p>SQLite is a lightweight, file-based relational database management system. It is included with Python, making it ideal for learning and small projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_installing_sqlite">Installing SQLite</h4>
<div class="paragraph">
<p>SQLite is pre-installed with Python. To check, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">python -c "import sqlite3; print('SQLite is available')"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_connecting_to_a_database">Step 2: Connecting to a Database</h3>
<div class="sect3">
<h4 id="_creating_and_connecting_to_a_sqlite_database">Creating and Connecting to a SQLite Database</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import sqlite3

# Connect to SQLite database (creates the database file if it doesn't exist)
connection = sqlite3.connect("insurance.db")

# Create a cursor to interact with the database
cursor = connection.cursor()

print("Connected to database successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_creating_tables">Step 3: Creating Tables</h3>
<div class="sect3">
<h4 id="_define_a_table_for_policies">Define a Table for Policies</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># SQL query to create a table
create_table_query = """
CREATE TABLE IF NOT EXISTS policies (
    policy_id TEXT PRIMARY KEY,
    policy_holder TEXT NOT NULL,
    policy_type TEXT NOT NULL,
    premium REAL NOT NULL
);
"""

# Execute the query
cursor.execute(create_table_query)
print("Table 'policies' created successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_inserting_data">Step 4: Inserting Data</h3>
<div class="sect3">
<h4 id="_insert_records_into_the_table">Insert Records into the Table</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Sample data
policy_data = [
    ("POL12345", "John Doe", "Life", 1200.50),
    ("POL12346", "Jane Smith", "Health", 2500.75),
    ("POL12347", "Jim Brown", "Vehicle", 1800.00)
]

# SQL query to insert data
insert_query = "INSERT INTO policies (policy_id, policy_holder, policy_type, premium) VALUES (?, ?, ?, ?);"

# Insert data
cursor.executemany(insert_query, policy_data)
connection.commit()
print("Data inserted successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_querying_data">Step 5: Querying Data</h3>
<div class="sect3">
<h4 id="_retrieve_data_from_the_table">Retrieve Data from the Table</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># SQL query to select all records
select_query = "SELECT * FROM policies;"

# Execute the query and fetch all results
cursor.execute(select_query)
rows = cursor.fetchall()

# Display the results
print("Policies:")
for row in rows:
    print(row)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_updating_data">Step 6: Updating Data</h3>
<div class="sect3">
<h4 id="_update_a_record">Update a Record</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># SQL query to update a record
update_query = "UPDATE policies SET premium = ? WHERE policy_id = ?;"

# Update the premium for a specific policy
cursor.execute(update_query, (1400.00, "POL12345"))
connection.commit()
print("Policy updated successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_deleting_data">Step 7: Deleting Data</h3>
<div class="sect3">
<h4 id="_delete_a_record">Delete a Record</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># SQL query to delete a record
delete_query = "DELETE FROM policies WHERE policy_id = ?;"

# Delete a policy by ID
cursor.execute(delete_query, ("POL12347",))
connection.commit()
print("Policy deleted successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_8_closing_the_connection">Step 8: Closing the Connection</h3>
<div class="sect3">
<h4 id="_always_close_the_database_connection">Always Close the Database Connection</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Close the cursor and connection
cursor.close()
connection.close()
print("Database connection closed")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_9_summary">Step 9: Summary</h3>
<div class="ulist">
<ul>
<li>
<p>SQLite is an easy-to-use database for small projects and learning.</p>
</li>
<li>
<p>CRUD operations allow you to interact with data effectively.</p>
</li>
<li>
<p>Always ensure you close database connections to avoid resource leaks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You now have a basic understanding of working with databases in Python!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_data_analytics_using_functional_programming">Lab: Data Analytics Using Functional Programming</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_19">Objective</h3>
<div class="paragraph">
<p>This lab focuses on data analytics using functional programming principles. Key goals include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extracting insights from data.</p>
</li>
<li>
<p>Building a composable pipeline for analytics.</p>
</li>
<li>
<p>Applying pure functions, higher-order functions, and data transformations.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_healthcare_analytics_for_bcbs">Scenario: Healthcare Analytics for BCBS</h3>
<div class="paragraph">
<p>You are tasked with performing data analytics for BCBS (Blue Cross Blue Shield) operations. The tasks include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Analyzing hospital and doctor collaboration.</p>
</li>
<li>
<p>Calculating company revenue from member data.</p>
</li>
<li>
<p>Identifying shared resources among companies.</p>
</li>
<li>
<p>Generating a summary of actionable insights.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_setting_up_data">Step 1: Setting Up Data</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Sample data for hospitals, doctors, and members
hospitals = [
    {"hospital_id": "H001", "name": "Community Hospital", "city": "Springfield"},
    {"hospital_id": "H002", "name": "Central Medical Center", "city": "Rivertown"}
]

doctors = [
    {"doctor_id": "D001", "name": "Dr. Smith", "specialty": "Cardiology", "hospital_id": "H001"},
    {"doctor_id": "D002", "name": "Dr. Johnson", "specialty": "Orthopedics", "hospital_id": "H002"}
]

bcbs_companies = [
    {"company_id": "C001", "name": "BCBS Springfield", "shared_office": True},
    {"company_id": "C002", "name": "BCBS Rivertown", "shared_office": False}
]

members = [
    {"member_id": "M001", "name": "Alice", "plan": "Basic", "company_id": "C001"},
    {"member_id": "M002", "name": "Bob", "plan": "Premium", "company_id": "C002"}
]

# Plan rates for revenue calculation
plan_rates = {"Basic": 100, "Premium": 200}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_data_transformation_with_functional_programming">Step 2: Data Transformation with Functional Programming</h3>
<div class="sect3">
<h4 id="_mapping_doctors_to_hospitals">Mapping Doctors to Hospitals</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def map_doctors_to_hospitals(doctors, hospitals):
    """Map each doctor to their respective hospital."""
    return [
        {
            **doctor,
            "hospital_name": next(
                (hospital["name"] for hospital in hospitals if hospital["hospital_id"] == doctor["hospital_id"]),
                "Unknown"
            )
        }
        for doctor in doctors
    ]

# Test mapping function
mapped_doctors = map_doctors_to_hospitals(doctors, hospitals)
print("Mapped Doctors:", mapped_doctors)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_enriching_member_data">Enriching Member Data</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def enrich_member_data(members, companies):
    """Add company name to each member record."""
    return [
        {
            **member,
            "company_name": next(
                (company["name"] for company in companies if company["company_id"] == member["company_id"]),
                "Unknown"
            )
        }
        for member in members
    ]

# Test enrichment function
enriched_members = enrich_member_data(members, bcbs_companies)
print("Enriched Members:", enriched_members)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_revenue_calculation">Step 3: Revenue Calculation</h3>
<div class="sect3">
<h4 id="_aggregating_revenue_by_company">Aggregating Revenue by Company</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def calculate_revenue_by_company(members, plan_rates):
    """Calculate total revenue for each company."""
    return {
        company_id: sum(plan_rates[member["plan"]] for member in members if member["company_id"] == company_id)
        for company_id in {member["company_id"] for member in members}
    }

# Test revenue calculation
revenue_by_company = calculate_revenue_by_company(members, plan_rates)
print("Revenue by Company:", revenue_by_company)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_resource_analysis">Step 4: Resource Analysis</h3>
<div class="sect3">
<h4 id="_counting_companies_sharing_resources">Counting Companies Sharing Resources</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def count_shared_resources(companies):
    """Count the number of companies sharing office resources."""
    return len([company for company in companies if company["shared_office"]])

# Test resource count
shared_resource_count = count_shared_resources(bcbs_companies)
print("Companies Sharing Resources:", shared_resource_count)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_building_an_analytics_pipeline">Step 5: Building an Analytics Pipeline</h3>
<div class="sect3">
<h4 id="_combining_all_steps">Combining All Steps</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def healthcare_analytics_pipeline(doctors, hospitals, members, companies, plan_rates):
    """Perform end-to-end analytics for BCBS data."""
    # Step 1: Map doctors to hospitals
    mapped_doctors = map_doctors_to_hospitals(doctors, hospitals)

    # Step 2: Enrich member data
    enriched_members = enrich_member_data(members, companies)

    # Step 3: Calculate revenue
    revenue = calculate_revenue_by_company(members, plan_rates)

    # Step 4: Analyze shared resources
    shared_resource_count = count_shared_resources(companies)

    return {
        "mapped_doctors": mapped_doctors,
        "enriched_members": enriched_members,
        "revenue": revenue,
        "shared_resource_count": shared_resource_count
    }

# Execute the pipeline
analytics_results = healthcare_analytics_pipeline(doctors, hospitals, members, bcbs_companies, plan_rates)
print("Analytics Results:", analytics_results)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_insights_and_summary">Step 6: Insights and Summary</h3>
<div class="sect3">
<h4 id="_insights">Insights</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Doctor-Hospital Mapping</strong>: Understand the distribution of doctors across hospitals.</p>
</li>
<li>
<p><strong>Enriched Member Data</strong>: Identify company affiliations for all members.</p>
</li>
<li>
<p><strong>Revenue Analysis</strong>: Calculate revenue generated by each company.</p>
</li>
<li>
<p><strong>Shared Resources</strong>: Determine collaboration levels among companies.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_summary">Summary</h4>
<div class="ulist">
<ul>
<li>
<p>Functional programming principles like pure functions and higher-order functions enable efficient data transformations.</p>
</li>
<li>
<p>Composing functions into an analytics pipeline ensures modular and maintainable code.</p>
</li>
<li>
<p>The real-world scenario of BCBS highlights practical applications of data analytics in healthcare.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_case_study_database_etl_and_analytics">Case Study: Database ETL and Analytics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_20">Objective</h3>
<div class="paragraph">
<p>This case study demonstrates how to use a database in an ETL (Extract, Transform, Load) pipeline and perform analytics using Python. The tasks include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extracting data from various sources.</p>
</li>
<li>
<p>Transforming and cleaning data.</p>
</li>
<li>
<p>Loading data into a SQLite database.</p>
</li>
<li>
<p>Performing analytics on the data.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_scenario_insurance_analytics_pipeline">Scenario: Insurance Analytics Pipeline</h3>
<div class="paragraph">
<p>An insurance company wants to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consolidate policyholder data from multiple sources.</p>
</li>
<li>
<p>Clean and transform the data to ensure consistency.</p>
</li>
<li>
<p>Store the processed data in a database.</p>
</li>
<li>
<p>Generate reports and insights for business decisions.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_setting_up_data_sources">Step 1: Setting Up Data Sources</h3>
<div class="sect3">
<h4 id="_sample_data_sources">Sample Data Sources</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Data from multiple sources
source_1 = [
    {"policy_id": "POL12345", "holder": "John Doe", "type": "Life", "premium": 1200.50},
    {"policy_id": "POL12346", "holder": "Jane Smith", "type": "Health", "premium": 2500.75}
]

source_2 = [
    {"policy_id": "POL12347", "holder": "Jim Brown", "type": "Vehicle", "premium": 1800.00},
    {"policy_id": "POL12348", "holder": "Alice Green", "type": "Life", "premium": 3000.00}
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_extracting_and_combining_data">Step 2: Extracting and Combining Data</h3>
<div class="sect3">
<h4 id="_extract_data_from_multiple_sources">Extract Data from Multiple Sources</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def extract_data(sources):
    """Combine data from multiple sources into a single list."""
    combined_data = []
    for source in sources:
        combined_data.extend(source)
    return combined_data

# Combine data from sources
raw_data = extract_data([source_1, source_2])
print("Extracted Data:", raw_data)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_transforming_data">Step 3: Transforming Data</h3>
<div class="sect3">
<h4 id="_cleaning_and_standardizing_data">Cleaning and Standardizing Data</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def transform_data(data):
    """Clean and standardize policy data."""
    transformed_data = []
    for record in data:
        transformed_record = {
            "policy_id": record["policy_id"].strip().upper(),
            "policy_holder": record["holder"].title(),
            "policy_type": record["type"].capitalize(),
            "premium": round(record["premium"], 2)
        }
        transformed_data.append(transformed_record)
    return transformed_data

# Transform the raw data
cleaned_data = transform_data(raw_data)
print("Transformed Data:", cleaned_data)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_loading_data_into_sqlite">Step 4: Loading Data into SQLite</h3>
<div class="sect3">
<h4 id="_create_database_and_table">Create Database and Table</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import sqlite3

# Connect to SQLite database
connection = sqlite3.connect("insurance_etl.db")
cursor = connection.cursor()

# Create a table for policies
create_table_query = """
CREATE TABLE IF NOT EXISTS policies (
    policy_id TEXT PRIMARY KEY,
    policy_holder TEXT NOT NULL,
    policy_type TEXT NOT NULL,
    premium REAL NOT NULL
);
"""
cursor.execute(create_table_query)
print("Table 'policies' created successfully")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_insert_data_into_the_database">Insert Data into the Database</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def load_data_to_db(data, cursor, connection):
    """Insert transformed data into the database."""
    insert_query = "INSERT OR REPLACE INTO policies (policy_id, policy_holder, policy_type, premium) VALUES (?, ?, ?, ?);"
    cursor.executemany(insert_query, [(record["policy_id"], record["policy_holder"], record["policy_type"], record["premium"]) for record in data])
    connection.commit()

# Load cleaned data into the database
load_data_to_db(cleaned_data, cursor, connection)
print("Data loaded into the database successfully")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_performing_analytics">Step 5: Performing Analytics</h3>
<div class="sect3">
<h4 id="_querying_the_database">Querying the Database</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Retrieve all policies
def fetch_policies(cursor):
    cursor.execute("SELECT * FROM policies;")
    return cursor.fetchall()

# Fetch and display all policies
policies = fetch_policies(cursor)
print("Policies in Database:", policies)

# Calculate total premiums by policy type
def calculate_premium_by_type(cursor):
    query = "SELECT policy_type, SUM(premium) AS total_premium FROM policies GROUP BY policy_type;"
    cursor.execute(query)
    return cursor.fetchall()

premium_summary = calculate_premium_by_type(cursor)
print("Premium Summary by Type:", premium_summary)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_generating_reports">Step 6: Generating Reports</h3>
<div class="sect3">
<h4 id="_displaying_insights">Displaying Insights</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">def generate_report(policies, premium_summary):
    """Generate a report summarizing policy data."""
    print("\n=== Insurance Policies Report ===")
    print("\nAll Policies:")
    for policy in policies:
        print(f"ID: {policy[0]}, Holder: {policy[1]}, Type: {policy[2]}, Premium: ${policy[3]:.2f}")

    print("\nPremium Summary by Type:")
    for summary in premium_summary:
        print(f"Type: {summary[0]}, Total Premium: ${summary[1]:.2f}")

# Generate and display the report
generate_report(policies, premium_summary)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_closing_the_database_connection">Step 7: Closing the Database Connection</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Close the database connection
cursor.close()
connection.close()
print("Database connection closed")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary_2">Summary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Extract</strong>: Combined data from multiple sources.</p>
</li>
<li>
<p><strong>Transform</strong>: Cleaned and standardized the data.</p>
</li>
<li>
<p><strong>Load</strong>: Stored the data in a SQLite database.</p>
</li>
<li>
<p><strong>Analytics</strong>: Queried the database to generate insights.</p>
</li>
<li>
<p><strong>Reporting</strong>: Created a detailed report summarizing the data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This ETL pipeline demonstrates how to manage and analyze data efficiently using Python and SQLite.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_logging_in_python">Lab: Logging in Python</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_objective_21">Objective</h3>
<div class="paragraph">
<p>This lab provides a comprehensive understanding of logging in Python, including:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The importance of logging.</p>
</li>
<li>
<p>Types of logging.</p>
</li>
<li>
<p>Log levels.</p>
</li>
<li>
<p>Logging destinations.</p>
</li>
<li>
<p>Creating a logging system for a real-world use case.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_introduction_to_logging">Step 1: Introduction to Logging</h3>
<div class="sect3">
<h4 id="_why_logging">Why Logging?</h4>
<div class="ulist">
<ul>
<li>
<p>Helps monitor application behavior.</p>
</li>
<li>
<p>Assists in debugging and error tracking.</p>
</li>
<li>
<p>Useful for auditing and tracking system events.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_types_of_logging">Types of Logging</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Application Logs</strong>: Logs generated by the application to track events or errors.</p>
</li>
<li>
<p><strong>System Logs</strong>: Logs from the operating system or infrastructure.</p>
</li>
<li>
<p><strong>Audit Logs</strong>: Logs for security and compliance tracking.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_log_levels">Log Levels</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>DEBUG</strong>: Detailed information, typically for diagnosing problems.</p>
</li>
<li>
<p><strong>INFO</strong>: Confirmation that things are working as expected.</p>
</li>
<li>
<p><strong>WARNING</strong>: Indication of potential problems.</p>
</li>
<li>
<p><strong>ERROR</strong>: Logs an error that has occurred.</p>
</li>
<li>
<p><strong>CRITICAL</strong>: Logs severe errors causing program termination.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_basic_logging_configuration">Step 2: Basic Logging Configuration</h3>
<div class="sect3">
<h4 id="_setting_up_logging">Setting Up Logging</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import logging

# Basic configuration
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(levelname)s - %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S'
)

# Test logging levels
logging.debug("This is a DEBUG message")
logging.info("This is an INFO message")
logging.warning("This is a WARNING message")
logging.error("This is an ERROR message")
logging.critical("This is a CRITICAL message")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_logging_to_a_file">Step 3: Logging to a File</h3>
<div class="sect3">
<h4 id="_writing_logs_to_a_file">Writing Logs to a File</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Configure logging to write to a file
logging.basicConfig(
    filename='application.log',
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    datefmt='%Y-%m-%d %H:%M:%S'
)

# Log messages
logging.info("Application started")
logging.warning("This is a warning message")
logging.error("An error occurred")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_advanced_logging_with_handlers">Step 4: Advanced Logging with Handlers</h3>
<div class="sect3">
<h4 id="_adding_multiple_handlers">Adding Multiple Handlers</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Create logger
logger = logging.getLogger('AdvancedLogger')
logger.setLevel(logging.DEBUG)

# Create file handler
file_handler = logging.FileHandler('advanced.log')
file_handler.setLevel(logging.ERROR)

# Create console handler
console_handler = logging.StreamHandler()
console_handler.setLevel(logging.DEBUG)

# Create formatter
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
file_handler.setFormatter(formatter)
console_handler.setFormatter(formatter)

# Add handlers to logger
logger.addHandler(file_handler)
logger.addHandler(console_handler)

# Log messages
logger.debug("This is a DEBUG message")
logger.info("This is an INFO message")
logger.warning("This is a WARNING message")
logger.error("This is an ERROR message")
logger.critical("This is a CRITICAL message")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_logging_to_external_destinations">Step 5: Logging to External Destinations</h3>
<div class="sect3">
<h4 id="_logging_to_json_file">Logging to JSON File</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">import json

class JSONFileHandler(logging.FileHandler):
    def emit(self, record):
        log_entry = {
            "timestamp": self.formatTime(record),
            "level": record.levelname,
            "message": record.msg
        }
        with open(self.baseFilename, 'a') as log_file:
            log_file.write(json.dumps(log_entry) + '\n')

# Configure JSON file handler
json_handler = JSONFileHandler('logs.json')
json_handler.setFormatter(logging.Formatter('%(asctime)s'))
logger.addHandler(json_handler)

logger.info("This log is written to a JSON file")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_scenario_insurance_policy_management_logging">Step 6: Scenario: Insurance Policy Management Logging</h3>
<div class="sect3">
<h4 id="_scenario_2">Scenario</h4>
<div class="paragraph">
<p>An insurance company wants to log events in their policy management system, including:
1. Policy creation.
2. Policy updates.
3. Error handling.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python"># Create logger for policy management
policy_logger = logging.getLogger('PolicyLogger')
policy_logger.setLevel(logging.INFO)

# File handler for policy events
policy_file_handler = logging.FileHandler('policy_events.log')
policy_file_handler.setFormatter(logging.Formatter('%(asctime)s - %(levelname)s - %(message)s'))
policy_logger.addHandler(policy_file_handler)

# Policy management functions
def create_policy(policy_id, holder, policy_type):
    policy_logger.info(f"Policy created: ID={policy_id}, Holder={holder}, Type={policy_type}")

def update_policy(policy_id, updates):
    policy_logger.info(f"Policy updated: ID={policy_id}, Updates={updates}")

def handle_error(error_message):
    policy_logger.error(f"Error occurred: {error_message}")

# Simulate events
create_policy("POL12345", "John Doe", "Life")
update_policy("POL12345", {"premium": 1500})
handle_error("Invalid policy ID")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_summary_6">Step 7: Summary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Log Levels</strong>: Use appropriate log levels (DEBUG, INFO, WARNING, ERROR, CRITICAL) based on the severity.</p>
</li>
<li>
<p><strong>Destinations</strong>: Logs can be written to files, consoles, or external systems.</p>
</li>
<li>
<p><strong>Handlers</strong>: Multiple handlers allow flexibility in logging to different destinations.</p>
</li>
<li>
<p><strong>Real-World Application</strong>: Logging helps in tracking events and debugging in systems like insurance management.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-01-27 17:56:11 +0550
</div>
</div>
</body>
</html>